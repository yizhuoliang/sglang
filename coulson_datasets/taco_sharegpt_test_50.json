[{"id": "TACO-0", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nYou are given a tree consisting of n vertices. A number is written on each vertex; the number on vertex i is equal to a_i.\n\nLet's denote the function g(x, y) as the greatest common divisor of the numbers written on the vertices belonging to the simple path from vertex x to vertex y (including these two vertices).\n\nFor every integer from 1 to 2 ⋅ 10^5 you have to count the number of pairs (x, y) (1 ≤ x ≤ y ≤ n) such that g(x, y) is equal to this number.\n\nInput\n\nThe first line contains one integer n — the number of vertices (1 ≤ n ≤ 2 ⋅ 10^5).\n\nThe second line contains n integers a_1, a_2, ..., a_n (1 ≤ a_i ≤ 2 ⋅ 10^5) — the numbers written on vertices.\n\nThen n - 1 lines follow, each containing two integers x and y (1 ≤ x, y ≤ n, x ≠ y) denoting an edge connecting vertex x with vertex y. It is guaranteed that these edges form a tree.\n\nOutput\n\nFor every integer i from 1 to 2 ⋅ 10^5 do the following: if there is no pair (x, y) such that x ≤ y and g(x, y) = i, don't output anything. Otherwise output two integers: i and the number of aforementioned pairs. You have to consider the values of i in ascending order.\n\nSee the examples for better understanding.\n\nExamples\n\nInput\n\n3\n1 2 3\n1 2\n2 3\n\n\nOutput\n\n1 4\n2 1\n3 1\n\n\nInput\n\n6\n1 2 4 8 16 32\n1 6\n6 3\n3 4\n4 2\n6 5\n\n\nOutput\n\n1 6\n2 5\n4 6\n8 1\n16 2\n32 1\n\n\nInput\n\n4\n9 16 144 6\n1 3\n2 3\n4 3\n\n\nOutput\n\n1 1\n2 1\n3 1\n6 2\n9 2\n16 2\n144 1\n\nExample input:\n```\n3\n2 3 4\n1 2\n2 3\n```\n\nExpected output for the example input:\n```\n1\n```\n\nMetadata: Difficulty: VERY_HARD | Time limit: 4.5 seconds | Memory limit: 256.0 megabytes | Source: https://codeforces.com/problemset/problem/990/G\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nfrom math import gcd\nn = int(input())\na = [int(i) for i in input().split()]\ntree = [[] for i in range(0, n)]\nfor i in range(0, n - 1):\n\ts = input().split()\n\tv1 = int(s[0]) - 1\n\tv2 = int(s[1]) - 1\n\ttree[v1].append(v2)\n\ttree[v2].append(v1)\nans = 0\nd = [{} for i in range(0, n)]\nfor i in range(0, n):\n\td[i] = {a[i]: 1}\n\tif a[i] > 1:\n\t\tans = 1\n\ndef dfs(curr, parent):\n\tfor child in tree[curr]:\n\t\tif child == parent:\n\t\t\tcontinue\n\t\tdfs(child, curr)\n\t\tnew_gcd = gcd(a[curr], a[child])\n\t\tif new_gcd > 1:\n\t\t\tfor (g_parent, p_parent) in d[curr].items():\n\t\t\t\tfor (g_child, p_child) in d[child].items():\n\t\t\t\t\tif gcd(g_parent, g_child) > 1:\n\t\t\t\t\t\tglobal ans\n\t\t\t\t\t\tans = max(ans, p_parent + p_child)\n\t\tfor (g_child, p_child) in d[child].items():\n\t\t\tnew_gcd = gcd(a[curr], g_child)\n\t\t\tif new_gcd > 1:\n\t\t\t\tif new_gcd in d[curr]:\n\t\t\t\t\td[curr][new_gcd] = max(d[curr][new_gcd], p_child + 1)\n\t\t\t\telse:\n\t\t\t\t\td[curr][new_gcd] = p_child + 1\ndfs(0, -1)\nprint(ans)\n```"}]}, {"id": "TACO-1", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nChef has an array A of N positive integers. Chef can perform the following operation any (possibly zero) number of times on the array.\n\nChoose any index i such that (1 < i ≤ N);\nChoose an integer X such that (1≤ X ≤ A_{i});\nSet A_{(i-1)} := A_{(i-1)} + X;\nSet A_{i} := A_{i} - X.\n\nHelp Chef to minimize the maximum value of array A using the above operations .\n\n------ Input Format ------ \n\n- The first line of input will contain a single integer T, denoting the number of test cases.\n- Each test case consists of two lines of input.\n- The first line of each test case contains a single integer N, the size of array A.\n- The second line of each test case contains N space-seperated integers, the elements of array A.\n\n------ Output Format ------ \n\nFor each test case, output on a new line, the minimized maximum value possible of array A.\n\n------ Constraints ------ \n\n$1 ≤ T ≤ 1000$\n$2 ≤ N ≤ 10^{5}$\n$0 ≤ A_{i} ≤ 10^{9}$\n- The sum of $N$ over all test cases won't exceed $10^{5}$.\n\n----- Sample Input 1 ------ \n3\n4\n1 5 7 6\n3\n5 15 19\n4\n10 3 5 7\n\n----- Sample Output 1 ------ \n5\n13\n10\n----- explanation 1 ------ \nTest case $1$: Consider the following $3$ operations on the array.\n- Choose $i = 3$ and $X = 4$. Here $X ≤ A_{3}$. After operation, the array becomes $[1,9,3,6]$.\n- Choose $i = 2$ and $X = 4$. Here $X ≤ A_{2}$. After operation, the array becomes $[5,5,3,6]$.\n- Choose $i = 4$ and $X = 1$. Here $X ≤ A_{4}$. After operation, the array becomes $[5,5,4,5]$.\n\nSo the minimum value of maximum element of array is $5$.\n\nTest case $2$: Consider the following $2$ operations on the array.\n- Choose $i = 2$ and $X = 8$. Here $X ≤ A_{2}$. After operation, the array becomes $[13, 7, 19]$.\n- Choose $i = 3$ and $X = 6$. Here $X ≤ A_{3}$. After operation, the array becomes $[13, 13, 13]$.\n\nSo the minimum value of maximum element of array is $5$.\n\nTest case $3$: We cannot make $A_{1}$ less than $10$ using any number of operations. Thus, the minimum value of maximum element is $10$.\n\nExample input:\n```\n3\n4\n1 5 7 6\n3\n5 15 19\n4\n10 3 5 7\n```\n\nExpected output for the example input:\n```\n5\n13\n10\n```\n\nMetadata: Difficulty: MEDIUM_HARD | Time limit: 1 seconds | Memory limit: 50000 bytes | Source: https://www.codechef.com/problems/MINMAXARR\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nfor _ in range(int(input())):\n\tn = int(input())\n\ta = list(map(int, input().split()))\n\tprint(max([-(-sum(a[:i + 1]) // (i + 1)) for (i, e) in enumerate(a)]))\n```"}]}, {"id": "TACO-2", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nMonocarp is playing a computer game. Now he wants to complete the first level of this game.\n\nA level is a rectangular grid of $2$ rows and $n$ columns. Monocarp controls a character, which starts in cell $(1, 1)$ — at the intersection of the $1$-st row and the $1$-st column.\n\nMonocarp's character can move from one cell to another in one step if the cells are adjacent by side and/or corner. Formally, it is possible to move from cell $(x_1, y_1)$ to cell $(x_2, y_2)$ in one step if $|x_1 - x_2| \\le 1$ and $|y_1 - y_2| \\le 1$. Obviously, it is prohibited to go outside the grid.\n\nThere are traps in some cells. If Monocarp's character finds himself in such a cell, he dies, and the game ends.\n\nTo complete a level, Monocarp's character should reach cell $(2, n)$ — at the intersection of row $2$ and column $n$.\n\nHelp Monocarp determine if it is possible to complete the level.\n\n\n-----Input-----\n\nThe first line contains a single integer $t$ ($1 \\le t \\le 100$) — the number of test cases. Then the test cases follow. Each test case consists of three lines.\n\nThe first line contains a single integer $n$ ($3 \\le n \\le 100$) — the number of columns.\n\nThe next two lines describe the level. The $i$-th of these lines describes the $i$-th line of the level — the line consists of the characters '0' and '1'. The character '0' corresponds to a safe cell, the character '1' corresponds to a trap cell.\n\nAdditional constraint on the input: cells $(1, 1)$ and $(2, n)$ are safe.\n\n\n-----Output-----\n\nFor each test case, output YES if it is possible to complete the level, and NO otherwise.\n\n\n-----Examples-----\n\nInput\n4\n3\n000\n000\n4\n0011\n1100\n4\n0111\n1110\n6\n010101\n101010\nOutput\nYES\nYES\nNO\nYES\n\n\n-----Note-----\n\nConsider the example from the statement.\n\nIn the first test case, one of the possible paths is $(1, 1) \\rightarrow (2, 2) \\rightarrow (2, 3)$.\n\nIn the second test case, one of the possible paths is $(1, 1) \\rightarrow (1, 2) \\rightarrow (2, 3) \\rightarrow (2, 4)$.\n\nIn the fourth test case, one of the possible paths is $(1, 1) \\rightarrow (2, 2) \\rightarrow (1, 3) \\rightarrow (2, 4) \\rightarrow (1, 5) \\rightarrow (2, 6)$.\n\nExample input:\n```\n4\n3\n000\n000\n4\n0011\n1100\n4\n0111\n1110\n6\n010101\n101010\n```\n\nExpected output for the example input:\n```\nYES\nYES\nNO\nYES\n```\n\nMetadata: Difficulty: EASY | Time limit: 2 seconds | Memory limit: 256 megabytes | Source: https://codeforces.com/problemset/problem/1598/A\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nI = input\nexec(int(I()) * \"I();print('YNEOS'[int(I(),2)&int(I(),2)>0::2]);\")\n```"}]}, {"id": "TACO-3", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nRead problems statements in Mandarin Chinese  and Russian. \n\nChef likes strings a lot but moreover he likes good strings. Chef calls a string str a good string if str starts and ends at different characters. For eg : strings such as abab , baccba , abc are all good strings whereas strings like aba, baab , baacaab are not good at all .\nToday, Chef has a special string P consisting of lower case letters \"c\" , \"h\" , \"e\" and \"f\" only. Chef wants to make some queries about his string P.\nEach of chef's query has the following form a b L R. For a given query, Chef wants to count the number of good strings which starts at letter a and ends at letter b such that starting index S_{i} and ending index E_{i} of a chosen substring satisfies L ≤ S_{i} < E_{i} ≤ R.\nNOTE\nTwo substrings P_{1} and P_{2} are considered to be different if either S_{1} != S_{2} or E_{1} != E_{2} where S_{1},E_{1} and S_{2},E_{2} are the starting and ending index of string P_{1} and string P_{2} respectively.\nChef is not able to accomplish this task efficiently. Can you help him ? \n\n------ Input ------ \n\nFirst line of the input contains a string P denoting the chef's special string. Next line of the input contains a single integer Q denoting the number of chef's queries. Next Q lines of the input contains four space separated parameters where the first two parameters are characters denoting a and b respectively and rest two are integers denoting L and R respectively.\n\n------ Output ------ \n\nFor each chef's query, print the required answer.\n\n------ Constraints ------ \n\n$1 ≤ |P| ≤ 10^{6}$\n$1 ≤ Q ≤ 10^{6}$\n$1 ≤ L ≤ R ≤ |P|$\n$P,a,b belongs to the set of lower case letters [c,h,e,f] and a != b. \t\t\n$$All test files are strictly according to constraints.$\n\n------ Subtasks ------ \n\n$ Subtask #1: 1≤|P|,Q≤10^{4} : 27 pts$\n$ Subtask #2: 1≤|P|,Q≤10^{5} : 25 pts$\n$ Subtask #3: 1≤|P|,Q≤10^{6} : 48 pts$\n\n------ Warning ------ \n\nLarge test data set, Prefer to use faster input/output methods .\n\n----- Sample Input 1 ------ \nchecfcheff\n5\nc h 1 10\nc f 1 10\ne c 1 10\nc f 1 5\nc f 6 10\n----- Sample Output 1 ------ \n4\n8\n2\n2\n2\n----- explanation 1 ------ \nQ1 : good strings are ch , checfch , cfch , ch \nQ2 : good strings are checf , checfchef , checfcheff , cf , cfchef , cfcheff , chef , cheff\n\nExample input:\n```\nchecfcheff\n5\nc h 1 10\nc f 1 10\ne c 1 10\nc f 1 5\nc f 6 10\n```\n\nExpected output for the example input:\n```\n4\n8\n2\n2\n2\n```\n\nMetadata: Difficulty: MEDIUM_HARD | Time limit: 1 seconds | Memory limit: 50000 bytes | Source: https://www.codechef.com/problems/STRQ\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nfrom itertools import accumulate\n\ndef prefixSum(seq):\n\treturn tuple(accumulate(seq))\nlookupDigit = {c: i for (i, c) in enumerate('chef')}\ndigits = tuple((lookupDigit[c] for c in input()))\nnDigitsUpTo = tuple((prefixSum((1 if d == digit else 0 for d in digits)) for digit in range(4)))\nnPairsEndingAt = tuple((tuple(([0] * len(digits) for b in range(4))) for a in range(4)))\nenumerateDigits = enumerate(digits)\nnext(enumerateDigits)\nfor (i, snd) in enumerateDigits:\n\tfor fst in (d for d in range(4) if d != snd):\n\t\tnPairsEndingAt[fst][snd][i] = nDigitsUpTo[fst][i - 1]\nnPairsUpTo = tuple((tuple((prefixSum(nPairsEndingAt[fst][snd]) for snd in range(4))) for fst in range(4)))\nfor queryIdx in range(int(input())):\n\t(fst, snd, begin, end) = input().split()\n\tfst = lookupDigit[fst]\n\tsnd = lookupDigit[snd]\n\tbegin = int(begin) - 1\n\tend = int(end) - 1\n\tpairsUpTo = nPairsUpTo[fst][snd]\n\tcount = pairsUpTo[end] - pairsUpTo[begin]\n\tif begin > 0:\n\t\tcount -= nDigitsUpTo[fst][begin - 1] * (nDigitsUpTo[snd][end] - nDigitsUpTo[snd][begin])\n\tprint(count)\n```"}]}, {"id": "TACO-4", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nRead problem statements in [Hindi], [Bengali], [Mandarin Chinese], [Russian], and [Vietnamese] as well.\n\nAs a health expert, Vinay is keeping a close watch on the ongoing pandemic of coronavirus disease (COVID-19). He thought of a different situation where there are $26$ types of viruses, named \"aorona\", \"borona\", \"corona\", ..., \"zorona\".\n\nYou are given a string $S$ with length $N$. There are $N$ people (numbered $1$ through $N$) and for each valid $i$, the $i$-th person is infected by exactly one type of virus named $S_{i}$orona (i.e. \"corona\" with the first letter replaced by the $i$-th character of $S$).\n\nYou should answer $Q$ queries. In each query:\nYou are given an integer $C$ denoting the number of available *isolation centers*.\nEach isolation center has an infinite capacity, but with the restriction that two people infected with the same type of virus cannot stay in the same isolation center.\nThere is also a *pending queue* with an infinite capacity and there are no restrictions on which people can be in the pending queue.\nInitially, the isolation centers and pending queue are empty.\nEach of the $N$ people should be placed in either the pending queue or one of the isolation centers.\nSince Vinay is busy finding a vaccine, he asks Swapnil to find a way to place the people in the pending queue and isolation centers such that the number of people in the pending queue is the smallest possible.\nHelp Swapnil find the size of the pending queue in that case.\n\n------  Input ------\nThe first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\nThe first line of each test case contains two space-separated integers $N$ and $Q$.\nThe second line contains a single string $S$.\nEach of the following $Q$ lines contains a single integer $C$ describing a query.\n\n------  Output ------\nFor each query, print a single line containing one integer ― the minimum size of the pending queue.\n\n------  Constraints ------\n$1 ≤ T, N, Q ≤ 10^{5}$\n$0 ≤ C ≤ 10^{9}$\n$|S| = N$\n$S$ contains only lowercase English letters\nthe sum of $N$ over all test cases does not exceed $10^{5}$\nthe sum of $Q$ over all test cases does not exceed $10^{5}$\n\n------  Subtasks ------\nSubtask #1 (20 points): $T, N, Q, C ≤ 10$\n\nSubtask #2 (80 points): original constraints\n\n----- Sample Input 1 ------ \n1\n\n20 2\n\nstayinghomesaveslife\n\n1\n\n3\n----- Sample Output 1 ------ \n6\n\n0\n----- explanation 1 ------ \nExample case 1: In the pending queue for the first query, there should be $2$ people with \"eorona\", $2$ with \"sorona\", $1$ with \"aorona\" and $1$ with \"iorona\".\n\nExample input:\n```\n1\n20 2\nstayinghomesaveslife\n1\n3\n```\n\nExpected output for the example input:\n```\n6\n0\n```\n\nMetadata: Difficulty: EASY | Time limit: 1 seconds | Memory limit: 50000 bytes | Source: https://www.codechef.com/problems/CORUS\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nfor _ in range(int(input())):\n\t(n, q) = map(int, input().split())\n\ts = list(input())\n\ts1 = [s.count(i) for i in set(s)]\n\tfor i in range(q):\n\t\tv = 0\n\t\tc = int(input())\n\t\tfor i in s1:\n\t\t\tif i > c:\n\t\t\t\tv += i - c\n\t\tprint(v)\n```"}]}, {"id": "TACO-5", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nYou've got array a[1], a[2], ..., a[n], consisting of n integers. Count the number of ways to split all the elements of the array into three contiguous parts so that the sum of elements in each part is the same. \n\nMore formally, you need to find the number of such pairs of indices i, j (2 ≤ i ≤ j ≤ n - 1), that $\\sum_{k = 1}^{i - 1} a_{k} = \\sum_{k = i}^{j} a_{k} = \\sum_{k = j + 1}^{n} a_{k}$.\n\n\n-----Input-----\n\nThe first line contains integer n (1 ≤ n ≤ 5·10^5), showing how many numbers are in the array. The second line contains n integers a[1], a[2], ..., a[n] (|a[i]| ≤  10^9) — the elements of array a.\n\n\n-----Output-----\n\nPrint a single integer — the number of ways to split the array into three parts with the same sum.\n\n\n-----Examples-----\nInput\n5\n1 2 3 0 3\n\nOutput\n2\n\nInput\n4\n0 1 -1 0\n\nOutput\n1\n\nInput\n2\n4 1\n\nOutput\n0\n\nExample input:\n```\n5\n1 2 3 0 3\n```\n\nExpected output for the example input:\n```\n2\n```\n\nMetadata: Difficulty: MEDIUM_HARD | Source: https://codeforces.com/problemset/problem/466/C\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nn = input()\na = [int(i) for i in input().split()]\nk = 0\nb = 0\nc = 0\ns = 0\nif sum(a) % 3 == 0:\n\tk = sum(a) / 3\n\tfor i in a[:-1]:\n\t\ts += i\n\t\tif s == 2 * k:\n\t\t\tb += c\n\t\tif s == k:\n\t\t\tc += 1\nprint(b)\n```"}]}, {"id": "TACO-6", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nBitland declared war on Chefland and sent an army to fight them, but Chefland defended efficiently and Bitland's army has been reduced to N$N$ soldiers. They have no chance of winning the war and do not want to surrender, so they are planning to commit group suicide. Josh, the leader of Bitland's remaining soldiers, has different plans — he wants to survive and somehow escape.\nThe soldiers are numbered 1$1$ through N$N$; Josh is soldier N$N$. The soldiers are going to stand in a circle in the order 1,2,…,P−1,N,P,P+1,…,N−1$1, 2, \\ldots, P-1, N, P, P+1, \\ldots, N-1$. Formally, they are standing in the circle in such a way that if Josh's position is P$P$ (1≤P≤N$1 \\le P \\le N$), then for each i$i$ (1≤i≤N−2$1 \\le i \\le N-2$, i≠P−1$i \\neq P-1$), soldier i+1$i+1$ is directly to the right of soldier i$i$, soldier P$P$ (if P≤N−1$P \\le N-1$) or 1$1$ (if P=N$P = N$) is directly to the right of Josh and Josh is directly to the right of soldier P−1$P-1$ (if P≥2$P \\ge 2$) or soldier N−1$N-1$ (if P=1$P = 1$); if 2≤P≤N−2$2 \\le P \\le N-2$, soldier 1$1$ is also directly to the right of soldier N−1$N-1$. For each i$i$ (1≤i≤N−1$1 \\le i \\le N-1$), soldier i$i$ has a sword with power Ai$A_i$. Josh plans to take a shield with sufficiently high defense power D$D$.\nFirst, the soldiers start to commit group suicide according to the following rules:\n- Initially, soldier 1$1$ is the attacking soldier.\n- If the attacking soldier is not Josh, this soldier attacks the soldier that is currently to his right.\n- When Josh is attacked with power a$a$, the current defense power of his shield decreases by a$a$, and if it becomes negative, Josh dies. When a different soldier is attacked, he does not try to defend and dies immediately. The power of the attacking soldier's sword does not change.\n- Then, the next living soldier to the right of the current attacking soldier becomes the attacking soldier and the process continues until there is only one soldier left.\nIt is clear that this way, Josh cannot be the last survivor. However, Chefland's general Chef plans to interrupt this process as soon as there are exactly two living soldiers of Bitland left (Josh wants to be one of them) by attacking them with Chefland's full firepower F$F$. Since this attack is unexpected, both attacked soldiers try to defend independently with the weapons they have. Josh survives if the current defense power of his shield is at least F$F$. Any other soldier survives only if the power of his sword is strictly greater than F$F$. Since Chefland does not attack again, if both Josh and another soldier survive, then the other soldier will kill Josh. Therefore, Josh wants to be the only survivor of Chefland's attack.\nYour task is to find the minimum possible value of D$D$ such that Josh survives if he chooses his position P$P$ optimally (or determine that he cannot survive) and the lowest position P$P$ such that Josh survives if he takes a shield with this defense power D$D$.\n\n-----Input-----\n- The first line of the input contains a single integer T$T$ denoting the number of test cases. The description of T$T$ test cases follows.\n- The first line of each test case contains a single integer N$N$.\n- The second line contains N−1$N-1$ space-separated integers A1,A2,…,AN−1$A_1, A_2, \\ldots, A_{N-1}$.\n- The third line contains a single integer F$F$.\n\n-----Output-----\nFor each test case, first, print a line containing the string \"possible\" if Josh can survive or \"impossible\" if he cannot (without quotes). Then, if he can survive, print a second line containing two space-separated integers P$P$ and D$D$.\n\n-----Constraints-----\n- 1≤T≤1,000$1 \\le T \\le 1,000$\n- 2≤N≤1,000,000$2 \\le N \\le 1,000,000$\n- 1≤Ai≤10,000$1 \\le A_i \\le 10,000$ for each valid i$i$\n- 1≤F≤10,000$1 \\le F \\le 10,000$\n- the sum of N$N$ over all test cases does not exceed 1,000,005$1,000,005$\n\n-----Subtasks-----\nSubtask #1 (30 points):\n- 1≤T≤10$1 \\le T \\le 10$\n- 2≤N≤100$2 \\le N \\le 100$\n- 1≤Ai≤100$1 \\le A_i \\le 100$ for each valid i$i$\n- 1≤F≤100$1 \\le F \\le 100$\nSubtask #2 (70 points): original constraints\n\n-----Example Input-----\n2\n5\n12 34 45 5\n10\n5\n10 15 43 20\n5\n\n-----Example Output-----\npossible\n4 100\nimpossible\n\n-----Explanation-----\nExample case 1: When Josh is at the position P=4$P = 4$, the soldiers' initial powers in clockwise order around the circle, starting with soldier 1$1$, are [12,34,45,D,5]$[12, 34, 45, D, 5]$ (D$D$ denotes Josh). Then, the following happens:\n- The soldier with power 12$12$ attacks the soldier with power 34$34$ and kills him.\n- The soldier with power 45$45$ attacks Josh, who defends. The living soldiers' powers are now [12,45,D−45,5]$[12, 45, D-45, 5]$ and Josh is the attacking soldier.\n- Josh does not attack, so the soldier to his right (with power 5$5$) becomes the attacking soldier. He attacks the soldier with power 12$12$ and kills him.\n- The soldier with power 45$45$ attacks Josh again and Josh defends again.\n- The soldier with power 5$5$ attacks the soldier with power 45$45$ and kills him.\n- Now, two soldiers are left: Josh (with a shield with defense power D−90$D-90$) and the soldier with a sword with power 5$5$. Each of them is attacked with firepower F=10$F=10$, so the power of Josh's shield drops to D−100$D-100$ and the other soldier dies.\nIf Josh survives, his shield's initial power D$D$ should be at least 45+45+10=100$45+45+10 = 100$. For all other positions P$P$, Josh cannot survive.\nExample case 2: Regardless of how large D$D$ is and which position Josh chooses, after Chefland's attack, a soldier of Bitland other than Josh will always survive. This soldier will then attack Josh until his shield breaks and he dies.\n\nExample input:\n```\n['2', '5', '12 34 45 5', '10', '5', '10 15 43 20', '5']\n```\n\nExpected output for the example input:\n```\npossible\n4 100\nimpossible\n```\n\nMetadata: Difficulty: VERY_HARD | Time limit: 1 seconds | Memory limit: 50000 bytes | Source: https://www.codechef.com/problems/CHFWAR\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\np2 = [1, 2, 4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768, 65536, 131072, 262144, 524288, 1048576, 2097152, 4194304, 8388608, 16777216]\nfor _ in range(int(input())):\n\tn = int(input()) - 1\n\ta = [int(x) for x in input().split()]\n\t(f, l) = (int(input()), [])\n\tfor i in range(n):\n\t\tif a[i] <= f:\n\t\t\tl.append(i)\n\t\tif i % 2 == 0:\n\t\t\ta.append(a[i])\n\tif len(l) == 0:\n\t\tprint('impossible')\n\t\tcontinue\n\tprint('possible')\n\t(d, p) = (10 ** 12, -1)\n\tfor i in l:\n\t\tx = -1 + n - i + (i + 1) // 2\n\t\tlast = i + x\n\t\ttd = f\n\t\tif i % 2 == 1:\n\t\t\ttd += a[i - 1]\n\t\tfor j in range(1, 25):\n\t\t\tif p2[j] > x:\n\t\t\t\tbreak\n\t\t\tla = last - x % p2[j]\n\t\t\tif la + p2[j - 1] > last:\n\t\t\t\ttd += a[la]\n\t\tif td < d:\n\t\t\t(d, p) = (td, i + 1)\n\tprint(p, d)\n```"}]}, {"id": "TACO-7", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nRead problems statements in English, Mandarin Chinese and Russian as well. \n\nRichard Winters: We're not lost, Private... we're in Normandy.\n\nIn WW2, allies have placed their mines on the ground  which can be considered as a gird of size N*M. Rows are numbered by integers from 1 to N and columns are numbered by integers from 1 to M. Each cell (i,j)  has a mine in it if (i+j) is divisible by 2. All the other cells are empty.\n\nTwo cells are neighbors if they share a boundary or a corner. Your aim is to move from the first row to the last row using some special rules that the automatic mine placing system follows. The mines won't blow if the following rules are followed:\n\nIf your current row number is odd, from a 'mined' cell(ie. cell having a mine in it) you can move only to a neighboring 'mined' cells in the next row, and similarly, from a 'not mined'(ie. an empty cell) cell you can only move to a neighboring 'not mined' cell in the next row.\n\nIf your current row number is even, you can move to any neighboring cell in the next row, irrespective of the mining.\n\nYou have to find the number of ways to reach row number N starting from row number 1, modulo 10^{9}+7. Two ways are different, if there is at least one different cell on the paths.\n\n------ Input ------ \n\nFirst line contains T, the number of testcases. Each testcase consists of N and M in one line.\n\n------ Output ------ \n\nFor each testcase, print the required answer in one line.\n\n------ Constraints ------ \n\n1 ≤ T ≤ 10\n1 ≤ N ≤ 10^{9}\n1 ≤ M ≤ 30\n\n------ Example ------ \n\nInput:\n2\n1 5\n2 5\n\nOutput:\n5\n8\n\n------ Explanation ------ \n\nExample case 1.You can start at any of the 5 cells available.\n\nExample case 2.\n\n8 ways are:\n\n(1,1) to (2,2)\n\n(1,2) to (2,1)\n\n(1,2) to (2,3)\n\n(1,3) to (2,2)\n\n(1,3) to (2,4)\n\n(1,4) to (2,3)\n\n(1,4) to (2,5)\n\n(1,5) to (2,4)\n\nExample input:\n```\n2\n1 5\n2 5\n```\n\nExpected output for the example input:\n```\n5\n8\n```\n\nMetadata: Difficulty: VERY_HARD | Time limit: 1 seconds | Memory limit: 50000 bytes | Source: https://www.codechef.com/problems/WW2\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nmod = 1000000007\n\ndef mmul(A, B):\n\ts = len(A)\n\tC = [[0 for i in range(s)] for j in range(s)]\n\tfor i in range(s):\n\t\tfor j in range(s):\n\t\t\tfor k in range(s):\n\t\t\t\tC[i][j] += A[i][k] * B[k][j]\n\t\t\t\tC[i][j] %= mod\n\treturn C\n\ndef mpow(A, N, I):\n\tif N == 0:\n\t\treturn I\n\tif N == 1:\n\t\treturn A\n\tret = mpow(A, N // 2, I)\n\tret1 = mmul(ret, ret)\n\tif N % 2 == 0:\n\t\treturn ret1\n\telse:\n\t\treturn mmul(ret1, A)\ntest = int(input())\nfor _ in range(test):\n\t(N, n) = [int(c) for c in input().split()]\n\tI = [[0 for i in range(n)] for j in range(n)]\n\tfor i in range(0, n):\n\t\tI[i][i] = 1\n\todd = [[0 for i in range(n)] for j in range(n)]\n\teven = [[0 for i in range(n)] for j in range(n)]\n\tfor i in range(n):\n\t\todd[i][i] = 1\n\t\tif i >= 1:\n\t\t\teven[i][i - 1] = 1\n\t\t\todd[i][i - 1] = 1\n\t\tif i < n - 1:\n\t\t\teven[i][i + 1] = 1\n\t\t\todd[i][i + 1] = 1\n\tT = mmul(even, odd)\n\tN -= 1\n\tans = mpow(T, N // 2, I)\n\tret = 0\n\tif N % 2:\n\t\tans = mmul(ans, even)\n\tfor i in ans:\n\t\tfor j in i:\n\t\t\tret += j\n\t\t\tret %= mod\n\tprint(ret)\n```"}]}, {"id": "TACO-8", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nYou have an array A of length N. In one operation, you can do the following: \nSelect any subarray A_{L \\ldots R} (1 ≤ L ≤ R ≤ N) and then add i to the i-th element of this subarray. Formally, we set A_{j} := A_{j} + (j - L + 1) for all L ≤ j ≤ R.\n\nFor example: if A = [2, 1, 5, 2] and we apply operation on A_{2 \\ldots 4} then A becomes [2, 1 + 1, 5 + 2, 2 + 3] = [2, 2, 7, 5].\n\nThe minimum number of such operations required to sort A in non-decreasing order is termed as the goodness of A.\n\nWe want to process Q updates on A of the following form:\n\\texttt{i x} : Set A_{i} := x where (1 ≤ i ≤ N).\n\nDetermine the goodness of A after each update.\n\n------ Input Format ------ \n\n- The first line contains a single integer T — the number of test cases. Then the test cases follow.\n- The first line of each test case contains two integers N and Q — the size of the array A and the number of updates.\n- The second line of each test case contains N space-separated integers A_{1}, A_{2}, \\dots, A_{N} denoting the array A.\n- The next Q lines each contain two integers i and x denoting the parameters of the update.\n\n------ Output Format ------ \n\nFor each test case, output Q integers, the goodness of the array after each update.\n\n------ Constraints ------ \n\n$1 ≤ T ≤ 10^{4}$\n$2 ≤ N ≤ 10^{5}$\n$1 ≤Q ≤N$\n$1 ≤A_{i} ≤10^{9}$\n$1 ≤x ≤10^{9}$\n- Sum of $N$ over all test cases does not exceed $2 \\cdot 10^{5}$.\n\n------ subtasks ------ \n\nSubtask 1 (50 points): $1 ≤Q ≤\\min(5, N)$\nSubtask 2 (50 points): Original constraints.\n\n----- Sample Input 1 ------ \n2\n3 2\n3 2 1\n3 10\n2 1\n4 2\n2 2 2 2\n4 2\n4 1\n\n----- Sample Output 1 ------ \n1\n2\n0\n1\n\n----- explanation 1 ------ \nTest Case 1: Initially $A = [3, 2, 1]$.\n- After first update: $A = [3, 2, 10]$. \n- Now we can apply the operation on $A_{1 \\ldots 2}$. Then $A$ becomes $[4, 4, 10]$. Therefore the goodness of $A$ is $1$.\n- After second update: $A = [3, 1, 10]$. \n-  Now we can apply the operation on $A_{2 \\ldots 2}$. $A$ becomes $[3, 2, 10]$. Now again we can apply the operation $A_{2 \\ldots 2}$. $A$ becomes $[3, 3, 10]$. Therefore the goodness of $A$ is $2$.\n\nTest Case 2: Initially $A = [2, 2, 2, 2]$.\n- After first update: $A = [2, 2, 2, 2]$. \n- $A$ is already in sorted order. Therefore the goodness of $A$ is $0$.\n- After second update: $A = [2, 2, 2, 1]$. \n-  Now we can apply the operation on $A_{3 \\ldots 4}$. $A$ becomes $[2, 2, 3, 3]$. Therefore the goodness of $A$ is $1$.\n\nExample input:\n```\n2\n3 2\n3 2 1\n3 10\n2 1\n4 2\n2 2 2 2\n4 2\n4 1\n```\n\nExpected output for the example input:\n```\n1\n2\n0\n1\n```\n\nMetadata: Difficulty: HARD | Time limit: 1 seconds | Memory limit: 50000 bytes | Source: https://www.codechef.com/problems/INCADD\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nfor i in range(int(input())):\n\t(n, q) = map(int, input().split())\n\tar = list(map(int, input().split()))\n\tmaxi = max([0] + [ar[i] - ar[i + 1] for i in range(n - 1)])\n\tfor i in range(q):\n\t\t(i, val) = map(int, input().split())\n\t\ti -= 1\n\t\tif i > 0 and ar[i - 1] - ar[i] == maxi or (i + 1 < n and ar[i] - ar[i + 1] == maxi):\n\t\t\tar[i] = val\n\t\t\tmaxi = max([0] + [ar[i] - ar[i + 1] for i in range(n - 1)])\n\t\telse:\n\t\t\tar[i] = val\n\t\t\tif i > 0:\n\t\t\t\tmaxi = max(maxi, ar[i - 1] - ar[i])\n\t\t\tif i + 1 < n:\n\t\t\t\tmaxi = max(maxi, ar[i] - ar[i + 1])\n\t\tprint(maxi)\n```"}]}, {"id": "TACO-9", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nSasha is taking part in a programming competition. In one of the problems she should check if some rooted trees are isomorphic or not. She has never seen this problem before, but, being an experienced participant, she guessed that she should match trees to some sequences and then compare these sequences instead of trees. Sasha wants to match each tree with a sequence a0, a1, ..., ah, where h is the height of the tree, and ai equals to the number of vertices that are at distance of i edges from root. \n\nUnfortunately, this time Sasha's intuition was wrong, and there could be several trees matching the same sequence. To show it, you need to write a program that, given the sequence ai, builds two non-isomorphic rooted trees that match that sequence, or determines that there is only one such tree.\n\nTwo rooted trees are isomorphic, if you can reenumerate the vertices of the first one in such a way, that the index of the root becomes equal the index of the root of the second tree, and these two trees become equal.\n\nThe height of a rooted tree is the maximum number of edges on a path from the root to any other vertex.\n\nInput\n\nThe first line contains a single integer h (2 ≤ h ≤ 105) — the height of the tree.\n\nThe second line contains h + 1 integers — the sequence a0, a1, ..., ah (1 ≤ ai ≤ 2·105). The sum of all ai does not exceed 2·105. It is guaranteed that there is at least one tree matching this sequence.\n\nOutput\n\nIf there is only one tree matching this sequence, print \"perfect\".\n\nOtherwise print \"ambiguous\" in the first line. In the second and in the third line print descriptions of two trees in the following format: in one line print <image> integers, the k-th of them should be the parent of vertex k or be equal to zero, if the k-th vertex is the root.\n\nThese treese should be non-isomorphic and should match the given sequence.\n\nExamples\n\nInput\n\n2\n1 1 1\n\n\nOutput\n\nperfect\n\n\nInput\n\n2\n1 2 2\n\n\nOutput\n\nambiguous\n0 1 1 3 3\n0 1 1 3 2\n\nNote\n\nThe only tree in the first example and the two printed trees from the second example are shown on the picture:\n\n<image>\n\nExample input:\n```\n10\n1 1 1 3 2 1 2 4 1 3 1\n```\n\nExpected output for the example input:\n```\nambiguous\n0 1 2 3 3 3 6 6 8 9 9 11 11 11 11 15 16 16 16 19\n0 1 2 3 3 3 6 5 8 9 9 11 11 11 11 15 16 16 16 19\n```\n\nMetadata: Difficulty: MEDIUM | Time limit: 2.0 seconds | Memory limit: 256.0 megabytes | Source: https://codeforces.com/problemset/problem/902/C\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nh = int(input())\na = list(map(int, input().split()))\nok = True\nfor i in range(h):\n\tif a[i] >= 2 and a[i + 1] >= 2:\n\t\tok = False\n\t\tidx = i + 1\nif ok:\n\tprint('perfect')\nelse:\n\tprint('ambiguous')\n\tans = []\n\tp = 0\n\tfor x in a:\n\t\tans.extend([p] * x)\n\t\tp = len(ans)\n\tprint(' '.join(map(str, ans)))\n\tans[sum(a[:idx])] -= 1\n\tprint(' '.join(map(str, ans)))\n```"}]}, {"id": "TACO-10", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nYou are given two integers $N$ and $M$. Find the number of sequences $A_1, A_2, \\ldots, A_N$, where each element is an integer between $1$ and $M$ (inclusive) and no three consecutive elements are equal. Since this number could be very large, compute it modulo $10^9+7$.\n\n-----Input-----\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\n- The first and only line of each test case contains two space-separated integers $N$ and $M$.\n\n-----Output-----\nFor each test case, print a single line containing one integer ― the number of valid sequences modulo $10^9+7$.\n\n-----Constraints-----\n- $1 \\le T \\le 10^5$\n- $1 \\le N, M \\le 10^{18}$\n\n-----Subtasks-----\nSubtask #1 (50 points):\n- $T \\le 20$\n- $N \\le 10^5$\nSubtask #2 (50 points): original constraints\n\n-----Example Input-----\n2 \n2 2\n3 4\n\n-----Example Output-----\n4\n60\n\nExample input:\n```\n['2', '2 2', '3 4']\n```\n\nExpected output for the example input:\n```\n['4', '60']\n```\n\nMetadata: Difficulty: VERY_HARD | Time limit: 2 seconds | Memory limit: 50000 bytes | Source: https://www.codechef.com/problems/CARR\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nt = int(input())\nmod = 10 ** 9 + 7\nfor _ in range(t):\n\t(n, m) = map(int, input().split())\n\tsame = [0]\n\tdiff = [m]\n\tfor i in range(n - 1):\n\t\ts = diff[-1]\n\t\td = (same[-1] + diff[-1]) * (m - 1)\n\t\tsame += [s % mod]\n\t\tdiff += [d % mod]\n\tprint((same[-1] + diff[-1]) % mod)\n```"}]}, {"id": "TACO-11", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nYou are given arrays A and B of length N each. Determine the number of *good* pairs.\n\nA pair (i,j) (1≤ i,j ≤ N) is said to be *good* if all of the following conditions are satisfied:\ni < j;\nA_{i} = B_{j};\nA_{j} = B_{i};\n\n------ Input Format ------ \n\n- First line will contain T, the number of test cases. Then the test cases follow.\n\nDescription of each test case:\n- First line contains an integer N - denoting the length of the arrays.\n- Second line contains N space-separated integers A_{1}, A_{2}, \\dots A_{N} - denoting the array A.\n- Third line contains N space-separated integers B_{1}, B_{2}, \\dots B_{N} - denoting the array B.\n\n------ Output Format ------ \n\nFor each test case, output the number of *good* pairs.\n\n------ Constraints ------ \n\n$1 ≤ T ≤ 1000$\n$2 ≤ N ≤ 10^{5}$\n$1 ≤ A_{i}, B_{i} ≤ 10^{9}$\n- Sum of $N$ over all test cases does not exceed $2 \\cdot 10^{5}$.\n\n----- Sample Input 1 ------ \n4\n3\n1 2 3\n3 2 1\n4\n1 2 3 4\n5 6 6 7\n3\n10 10 10\n10 10 10\n4\n4 8 1 1\n8 4 1 1\n\n----- Sample Output 1 ------ \n1\n0\n3\n2\n\n----- explanation 1 ------ \nTest Case $1$: The only *good* pair $(i,j)$ is $(1,3)$. Here,\n- $1 < 3$\n- $A_{1} = 1$ and $B_{3} = 1$. Thus, $A_{1} = B_{3}$.\n- $A_{3} = 3$ and $B_{1} = 3$. Thus, $A_{3} = B_{1}$.\n\nTest Case $2$: There are no *good* pairs.\n\nTest Case $3$: There are $3$ good pairs $(i,j)$. These are $(1,2), (1,3),$ and $(2,3)$.\n\nTest Case $4$: There are $2$ good pairs $(i,j)$. These are $(1,2)$ and $(3,4)$.\n\nExample input:\n```\n4\n3\n1 2 3\n3 2 1\n4\n1 2 3 4\n5 6 6 7\n3\n10 10 10\n10 10 10\n4\n4 8 1 1\n8 4 1 1\n```\n\nExpected output for the example input:\n```\n1\n0\n3\n2\n```\n\nMetadata: Difficulty: MEDIUM | Time limit: 1 seconds | Memory limit: 50000 bytes | Source: https://www.codechef.com/problems/GOODPAIRS\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nt = int(input())\nwhile t:\n\tn = int(input())\n\ta = input().split()\n\tb = input().split()\n\tdump = {}\n\tcount = 0\n\tfor i in range(n):\n\t\tcount += dump.get((b[i], a[i]), 0)\n\t\tdump[a[i], b[i]] = dump.get((a[i], b[i]), 0) + 1\n\tprint(count)\n\tt -= 1\n```"}]}, {"id": "TACO-12", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nThe legend of the foundation of Vectorland talks of two integers $x$ and $y$. Centuries ago, the array king placed two markers at points $|x|$ and $|y|$ on the number line and conquered all the land in between (including the endpoints), which he declared to be Arrayland. Many years later, the vector king placed markers at points $|x - y|$ and $|x + y|$ and conquered all the land in between (including the endpoints), which he declared to be Vectorland. He did so in such a way that the land of Arrayland was completely inside (including the endpoints) the land of Vectorland.\n\nHere $|z|$ denotes the absolute value of $z$.\n\nNow, Jose is stuck on a question of his history exam: \"What are the values of $x$ and $y$?\" Jose doesn't know the answer, but he believes he has narrowed the possible answers down to $n$ integers $a_1, a_2, \\dots, a_n$. Now, he wants to know the number of unordered pairs formed by two different elements from these $n$ integers such that the legend could be true if $x$ and $y$ were equal to these two values. Note that it is possible that Jose is wrong, and that no pairs could possibly make the legend true.\n\n\n-----Input-----\n\nThe first line contains a single integer $n$ ($2 \\le n \\le 2 \\cdot 10^5$)  — the number of choices.\n\nThe second line contains $n$ pairwise distinct integers $a_1, a_2, \\dots, a_n$ ($-10^9 \\le a_i \\le 10^9$) — the choices Jose is considering.\n\n\n-----Output-----\n\nPrint a single integer number — the number of unordered pairs $\\{x, y\\}$ formed by different numbers from Jose's choices that could make the legend true.\n\n\n-----Examples-----\nInput\n3\n2 5 -3\n\nOutput\n2\n\nInput\n2\n3 6\n\nOutput\n1\n\n\n\n-----Note-----\n\nConsider the first sample. For the pair $\\{2, 5\\}$, the situation looks as follows, with the Arrayland markers at $|2| = 2$ and $|5| = 5$, while the Vectorland markers are located at $|2 - 5| = 3$ and $|2 + 5| = 7$:\n\n [Image] \n\nThe legend is not true in this case, because the interval $[2, 3]$ is not conquered by Vectorland. For the pair $\\{5, -3\\}$ the situation looks as follows, with Arrayland consisting of the interval $[3, 5]$ and Vectorland consisting of the interval $[2, 8]$:\n\n [Image] \n\nAs Vectorland completely contains Arrayland, the legend is true. It can also be shown that the legend is true for the pair $\\{2, -3\\}$, for a total of two pairs.\n\nIn the second sample, the only pair is $\\{3, 6\\}$, and the situation looks as follows:\n\n [Image] \n\nNote that even though Arrayland and Vectorland share $3$ as endpoint, we still consider Arrayland to be completely inside of Vectorland.\n\nExample input:\n```\n3\n2 5 -3\n```\n\nExpected output for the example input:\n```\n2\n```\n\nMetadata: Difficulty: MEDIUM | Source: https://codeforces.com/problemset/problem/1166/C\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nn = int(input())\na = sorted(map(abs, map(int, input().split())))\nj = ans = 0\nfor i in range(n):\n\twhile 2 * a[j] < a[i]:\n\t\tj += 1\n\tans += i - j\nprint(ans)\n```"}]}, {"id": "TACO-13", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\n<image>\n\nWilliam is hosting a party for n of his trader friends. They started a discussion on various currencies they trade, but there's an issue: not all of his trader friends like every currency. They like some currencies, but not others.\n\nFor each William's friend i it is known whether he likes currency j. There are m currencies in total. It is also known that a trader may not like more than p currencies.\n\nBecause friends need to have some common topic for discussions they need to find the largest by cardinality (possibly empty) subset of currencies, such that there are at least ⌈ n/2 ⌉ friends (rounded up) who like each currency in this subset.\n\nInput\n\nThe first line contains three integers n, m and p (1 ≤ n ≤ 2 ⋅ 10^5, 1 ≤ p ≤ m ≤ 60, 1 ≤ p ≤ 15), which is the number of trader friends, the number of currencies, the maximum number of currencies each friend can like.\n\nEach of the next n lines contain m characters. The j-th character of i-th line is 1 if friend i likes the currency j and 0 otherwise. It is guaranteed that the number of ones in each line does not exceed p.\n\nOutput\n\nPrint a string of length m, which defines the subset of currencies of the maximum size, which are liked by at least half of all friends. Currencies belonging to this subset must be signified by the character 1.\n\nIf there are multiple answers, print any.\n\nExamples\n\nInput\n\n\n3 4 3\n1000\n0110\n1001\n\n\nOutput\n\n\n1000\n\n\nInput\n\n\n5 5 4\n11001\n10101\n10010\n01110\n11011\n\n\nOutput\n\n\n10001\n\nNote\n\nIn the first sample test case only the first currency is liked by at least ⌈ 3/2 ⌉ = 2 friends, therefore it's easy to demonstrate that a better answer cannot be found.\n\nIn the second sample test case the answer includes 2 currencies and will be liked by friends 1, 2, and 5. For this test case there are other currencies that are liked by at least half of the friends, but using them we cannot achieve a larger subset size.\n\nExample input:\n```\n2 30 15\n111010000000110001001001111111\n000101111111001110110110000000\n```\n\nExpected output for the example input:\n```\n000101111111001110110110000000\n```\n\nMetadata: Difficulty: VERY_HARD | Time limit: 3.0 seconds | Memory limit: 256.0 megabytes | Source: https://codeforces.com/problemset/problem/1523/D\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nimport sys\ninput = sys.stdin.readline\nfrom random import shuffle\n(n, m, p) = map(int, input().split())\nA = [input()[:-1] for _ in range(n)]\norder = list(range(n))\nshuffle(order)\nbest = 0\nsub = '0' * m\nfor it in range(min(n, 10)):\n\tx = order[it]\n\tbits = [j for j in range(m) if A[x][j] == '1']\n\tsz = len(bits)\n\tcnt = [0] * (1 << sz)\n\tfor i in range(n):\n\t\tcur = sum((1 << j for j in range(sz) if A[i][bits[j]] == '1'))\n\t\tcnt[cur] += 1\n\tfor i in range(sz):\n\t\tfor mask in range(1 << sz):\n\t\t\tif mask & 1 << i:\n\t\t\t\tcnt[mask ^ 1 << i] += cnt[mask]\n\tfor mask in range(1 << sz):\n\t\tif 2 * cnt[mask] >= n and bin(mask).count('1') > best:\n\t\t\tbest = bin(mask).count('1')\n\t\t\tsub = ['0'] * m\n\t\t\tfor i in range(sz):\n\t\t\t\tif mask >> i & 1:\n\t\t\t\t\tsub[bits[i]] = '1'\n\t\t\tsub = ''.join(sub)\nprint(sub)\n```"}]}, {"id": "TACO-14", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nLittle penguin Polo has an n × m matrix, consisting of integers. Let's index the matrix rows from 1 to n from top to bottom and let's index the columns from 1 to m from left to right. Let's represent the matrix element on the intersection of row i and column j as a_{ij}.\n\nIn one move the penguin can add or subtract number d from some matrix element. Find the minimum number of moves needed to make all matrix elements equal. If the described plan is impossible to carry out, say so.\n\n\n-----Input-----\n\nThe first line contains three integers n, m and d (1 ≤ n, m ≤ 100, 1 ≤ d ≤ 10^4) — the matrix sizes and the d parameter. Next n lines contain the matrix: the j-th integer in the i-th row is the matrix element a_{ij} (1 ≤ a_{ij} ≤ 10^4).\n\n\n-----Output-----\n\nIn a single line print a single integer — the minimum number of moves the penguin needs to make all matrix elements equal. If that is impossible, print \"-1\" (without the quotes).\n\n\n-----Examples-----\nInput\n2 2 2\n2 4\n6 8\n\nOutput\n4\n\nInput\n1 2 7\n6 7\n\nOutput\n-1\n\nExample input:\n```\n2 2 2\n2 4\n6 8\n```\n\nExpected output for the example input:\n```\n4\n```\n\nMetadata: Difficulty: MEDIUM | Source: https://codeforces.com/problemset/problem/289/B\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\n(n, m, d) = map(int, input().split())\na = []\nfor i in ' ' * n:\n\ta += list(map(int, input().split()))\na.sort()\nmid = a[n * m // 2]\nc = 0\nfor i in a:\n\tx = abs(i - mid)\n\tif x % d != 0:\n\t\tprint(-1)\n\t\texit(0)\n\tc += x // d\nprint(c)\n```"}]}, {"id": "TACO-15", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nRead problems statements in Mandarin Chinese, Russian and Vietnamese as well. \n\nIt is a period of civil war. Rebel spaceships, striking from a hidden base, have won their first victory against the evil Galactic Empire. \n\nIn light of these events, Chef, the leader of the rebel alliance, wants to build safe connections in galaxy with N stars. There are M bidirectional space roads in space that connect pairs of stars together. Travelling through one space road takes 1 day. \n\nTo avoid detection by the Empire, Chef decided that rebels must never travel alone. Instead, they must travel using armored rebel spaceships. Each spaceship is designated two stars, and a fixed route between these stars. A route is just a path composed of roads that connects two stars, but to increase security, Chef added the following restrictions on routes:\n\nEach route must be traversable within at most K days.\nRoads may be traversed any number times in a single route, in both directions.\n\nAfter some time has passed, Chef and his engineers were able to build a spaceship for every possible route between stars.\n\nUnfortunately, the powerful Empire discovered this and plans to destroy these spaceships to maintain control of the galaxy. Specifically, they deployed a new superweapon called the Death Starkiller Base, which is able to destroy X spaceships at once! It works by analyzing all spaceships that pass through Empire-controlled star systems.\n\nUnfortunately, since the destruction of the Empire's two previous superweapons, the budget for the new superweapon is crippled, so the Death Starkiller Base has some severe restrictions:\n\nIt can only destroy exactly X spaceships per usage. Not more, not less.\nIt can only destroy a group of spaceships if they travel between the same pair of stars.\n\nDespite these flaws, the Empire still used the superweapon as many times as possible, until there aren't enough groups of spaceships any more to destroy.\n\nTo avoid more casualties, Chef decided to retire most of the surviving spaceships. Chef wants to retire as many spaceships as possible, but in order to stay connected, Chef wants to do this such that there is still a way to get from any star to another using spaceships. How many ways are there for Chef to retire spaceships so that this is satisfied?\n\nNote that a spaceship can only pick up or drop off people at the start or end of its journey, so a single spaceship that happens to pass through all stars isn't enough (unless there are only two stars).\n\n------ Input ------ \n\nThe first line of input contains four positive integers - N, M, X, K. The next M lines each contains two integers U, V stars which connect by space road. All space roads are pairwise distinct.\n\n------ Output ------ \n\nOutput a single line containing a single integer — the solution of Chef's problem.\n\n------ Constraints ------ \n\n$1 ≤ N ≤ 100$\n$0 ≤ M ≤ Nx(N-1)/2$\n$1 ≤ K ≤ 10^{18}$\n$1 ≤ X ≤ 7777777$\n$1 ≤ U < V ≤ N $\n$ Each space road (U, V) will be in input at most once. $\n\n------ Subtasks ------ \n\n$Subtask 1: (10 pts) N ≤ 5.$Subtask 2: (25 pts) N ≤ 30.$Subtask 3: (65 pts) Original constraints. \n\n------ Example ------ \n\nInput:\n3 3 100 3\n1 2\n2 3\n3 1\n\nOutput:\n75\n\nInput:\n3 3 2 3\n1 2\n2 3\n3 1\n\nOutput:\n3\n\nInput:\n5 8 10000 1000000000\n4 5\n3 5\n1 4\n1 3\n2 3\n2 4\n1 2\n1 5\n\nOutput:\n2220611572265625\n\n------ Explanation: ------ \n\nExample case 1. There are five possible routes between stars 1 and 2 traversable in not more than 3 days: {1-2, 1-3-2, 1-2-1-2, 1-2-3-2, 1-3-1-2}. There are also five routes between stars 2 and 3, and also between stars 1 and 3. There are three possible plans for the remaining routes:\n\n$A route remains between 1 and 2, and between 2 and 3. There are 5 x 5 = 25 ways to do this.$\n$A route remains between 2 and 3, and between 3 and 1. There are 5 x 5 = 25 ways to do this.$\n$A route remains between 3 and 1, and between 1 and 2. There are 5 x 5 = 25 ways to do this.$\n\nAll in all, there are 25 + 25 + 25 = 75 plans.\n\nExample input:\n```\n3 3 100 3\n1 2\n2 3\n3 1\n```\n\nExpected output for the example input:\n```\n75\n```\n\nMetadata: Difficulty: VERY_HARD | Time limit: 4 seconds | Memory limit: 50000 bytes | Source: https://www.codechef.com/problems/STARROAD\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nimport sys\nimport numpy as np\n\ndef mpow_mod(M, k, mod):\n\tret = np.identity(M.shape[0], dtype=np.int64)\n\twhile k > 0:\n\t\tif k & 1:\n\t\t\tret = ret.dot(M)\n\t\t\tret %= mod\n\t\tM = M.dot(M)\n\t\tM %= mod\n\t\tk >>= 1\n\treturn ret\n\ndef lap(M):\n\tn = M.shape[0]\n\tL = np.zeros((n, n), dtype=np.int64)\n\tL[range(n), range(n)] = np.sum(M, 0)\n\tL -= M\n\treturn L\n\ndef int_array(m):\n\tret = np.array([int(x) for x in m.flat], dtype=object)\n\tret = ret.reshape(m.shape)\n\treturn ret\n\ndef mred(m):\n\tn = m.shape[0]\n\tret = m[1:, 1:]\n\tfor i in range(n - 1):\n\t\tfor j in range(n - 1):\n\t\t\tret[i, j] = m[0, 0] * m[i + 1, j + 1] - m[i + 1, 0] * m[0, j + 1]\n\treturn ret\n\ndef det(m):\n\ta = 1\n\twhile m.shape[0] > 1:\n\t\tb = m[0, 0]\n\t\tif a == 0:\n\t\t\treturn 0\n\t\tm = mred(m) // a\n\t\ta = b\n\treturn m[0, 0]\n\ndef solve(M, k, x):\n\tn = M.shape[0]\n\tI = np.identity(n, dtype=np.int64)\n\tM0 = np.vstack((np.hstack((M, I)), np.hstack((I * 0, I))))\n\tM1 = mpow_mod(M0, k + 1, x)[:n, n:]\n\tM1[range(n), range(n)] = 0\n\tif n == 1:\n\t\treturn 1\n\tif n == 2:\n\t\treturn M1[0, 1]\n\tL = lap(M1)[1:, 1:]\n\treturn det(int_array(L))\nf = sys.stdin\n(n, m, x, k) = map(int, f.readline().split())\nM = np.zeros((n, n), dtype=np.int64)\nfor i in range(m):\n\t(a, b) = map(int, f.readline().split())\n\tM[a - 1, b - 1] = M[b - 1, a - 1] = 1\nprint(solve(M, k, x))\n```"}]}, {"id": "TACO-16", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nAfter returning from the army Makes received a gift — an array a consisting of n positive integer numbers. He hadn't been solving problems for a long time, so he became interested to answer a particular question: how many triples of indices (i,  j,  k) (i < j < k), such that a_{i}·a_{j}·a_{k} is minimum possible, are there in the array? Help him with it!\n\n\n-----Input-----\n\nThe first line of input contains a positive integer number n (3 ≤ n ≤ 10^5) — the number of elements in array a. The second line contains n positive integer numbers a_{i} (1 ≤ a_{i} ≤ 10^9) — the elements of a given array.\n\n\n-----Output-----\n\nPrint one number — the quantity of triples (i,  j,  k) such that i,  j and k are pairwise distinct and a_{i}·a_{j}·a_{k} is minimum possible.\n\n\n-----Examples-----\nInput\n4\n1 1 1 1\n\nOutput\n4\n\nInput\n5\n1 3 2 3 4\n\nOutput\n2\n\nInput\n6\n1 3 3 1 3 2\n\nOutput\n1\n\n\n\n-----Note-----\n\nIn the first example Makes always chooses three ones out of four, and the number of ways to choose them is 4.\n\nIn the second example a triple of numbers (1, 2, 3) is chosen (numbers, not indices). Since there are two ways to choose an element 3, then the answer is 2.\n\nIn the third example a triple of numbers (1, 1, 2) is chosen, and there's only one way to choose indices.\n\nExample input:\n```\n4\n1 1 1 1\n```\n\nExpected output for the example input:\n```\n4\n```\n\nMetadata: Difficulty: MEDIUM | Source: https://codeforces.com/problemset/problem/817/B\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nfrom math import factorial as f\ninput()\na = sorted(input().split(), key=int)\n(x, y) = (a.count(a[2]), a[:3].count(a[2]))\nprint(f(x) // (f(y) * f(x - y)))\n```"}]}, {"id": "TACO-17", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nConnected undirected weighted graph without self-loops and multiple edges is given. Graph contains n vertices and m edges.\n\nFor each edge (u, v) find the minimal possible weight of the spanning tree that contains the edge (u, v).\n\nThe weight of the spanning tree is the sum of weights of all edges included in spanning tree.\n\nInput\n\nFirst line contains two integers n and m (1 ≤ n ≤ 2·105, n - 1 ≤ m ≤ 2·105) — the number of vertices and edges in graph.\n\nEach of the next m lines contains three integers ui, vi, wi (1 ≤ ui, vi ≤ n, ui ≠ vi, 1 ≤ wi ≤ 109) — the endpoints of the i-th edge and its weight.\n\nOutput\n\nPrint m lines. i-th line should contain the minimal possible weight of the spanning tree that contains i-th edge.\n\nThe edges are numbered from 1 to m in order of their appearing in input.\n\nExamples\n\nInput\n\n5 7\n1 2 3\n1 3 1\n1 4 5\n2 3 2\n2 5 3\n3 4 2\n4 5 4\n\n\nOutput\n\n9\n8\n11\n8\n8\n8\n9\n\nExample input:\n```\n2 1\n1 2 42\n```\n\nExpected output for the example input:\n```\n42\n```\n\nMetadata: Difficulty: HARD | Time limit: 2.0 seconds | Memory limit: 256.0 megabytes | Source: https://codeforces.com/problemset/problem/609/E\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\ndef find(u):\n\tif u == par[u]:\n\t\treturn u\n\tpar[u] = find(par[u])\n\treturn par[u]\n\ndef union(u, v):\n\tif len(ev[u]) < len(ev[v]):\n\t\t(u, v) = (v, u)\n\tpar[v] = u\n\tfor j in ev[v] & ev[u]:\n\t\tans[j] -= w\n\tev[u] ^= ev[v]\n(n, m) = map(int, input().split())\nev = [set() for _ in range(n + 1)]\n(ans, d) = ([0] * m, [])\nfor i in range(m):\n\t(u, v, w) = map(int, input().split())\n\td.append((w, u, v))\n\tev[u].add(i)\n\tev[v].add(i)\n\tans[i] = w\npar = [i for i in range(n + 1)]\ng = 0\nd.sort()\nfor (w, u, v) in d:\n\t(u, v) = (find(u), find(v))\n\tif u != v:\n\t\tg += w\n\t\tunion(u, v)\nfor i in range(m):\n\tans[i] += g\nprint(*ans)\n```"}]}, {"id": "TACO-18", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nIn a far away land, there are two cities near a river. One day, the cities decide that they have too little space and would like to reclaim some of the river area into land.\n\nThe river area can be represented by a grid with r rows and exactly two columns — each cell represents a rectangular area. The rows are numbered 1 through r from top to bottom, while the columns are numbered 1 and 2.\n\nInitially, all of the cells are occupied by the river. The plan is to turn some of those cells into land one by one, with the cities alternately choosing a cell to reclaim, and continuing until no more cells can be reclaimed.\n\nHowever, the river is also used as a major trade route. The cities need to make sure that ships will still be able to sail from one end of the river to the other. More formally, if a cell (r, c) has been reclaimed, it is not allowed to reclaim any of the cells (r - 1, 3 - c), (r, 3 - c), or (r + 1, 3 - c).\n\nThe cities are not on friendly terms, and each city wants to be the last city to reclaim a cell (they don't care about how many cells they reclaim, just who reclaims a cell last). The cities have already reclaimed n cells. Your job is to determine which city will be the last to reclaim a cell, assuming both choose cells optimally from current moment.\n\n\n-----Input-----\n\nThe first line consists of two integers r and n (1 ≤ r ≤ 100, 0 ≤ n ≤ r). Then n lines follow, describing the cells that were already reclaimed. Each line consists of two integers: r_{i} and c_{i} (1 ≤ r_{i} ≤ r, 1 ≤ c_{i} ≤ 2), which represent the cell located at row r_{i} and column c_{i}. All of the lines describing the cells will be distinct, and the reclaimed cells will not violate the constraints above.\n\n\n-----Output-----\n\nOutput \"WIN\" if the city whose turn it is to choose a cell can guarantee that they will be the last to choose a cell. Otherwise print \"LOSE\".\n\n\n-----Examples-----\nInput\n3 1\n1 1\n\nOutput\nWIN\n\nInput\n12 2\n4 1\n8 1\n\nOutput\nWIN\n\nInput\n1 1\n1 2\n\nOutput\nLOSE\n\n\n\n-----Note-----\n\nIn the first example, there are 3 possible cells for the first city to reclaim: (2, 1), (3, 1), or (3, 2). The first two possibilities both lose, as they leave exactly one cell for the other city. [Image] \n\nHowever, reclaiming the cell at (3, 2) leaves no more cells that can be reclaimed, and therefore the first city wins. $\\text{-}$ \n\nIn the third example, there are no cells that can be reclaimed.\n\nExample input:\n```\n3 1\n1 1\n```\n\nExpected output for the example input:\n```\nWIN\n```\n\nMetadata: Difficulty: HARD | Source: https://codeforces.com/problemset/problem/335/C\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\n(r, n) = [int(x) for x in input().split()]\ncells = [[int(x) for x in input().split()] for i in range(n)]\ncells.sort()\nout = False\nres = {True: 'WIN', False: 'LOSE'}\nif len(cells) == 0:\n\tprint(res[r % 2 == 1])\nelse:\n\tout = False\n\tfor i in range(1, n):\n\t\tout ^= (cells[i][0] - cells[i - 1][0] - 1) % 2 ^ (cells[i][1] != cells[i - 1][1])\n\tdif = abs(cells[0][0] - 1 - (r - cells[-1][0]))\n\t(hi, lo) = (max(cells[0][0] - 1, r - cells[-1][0]), min(cells[0][0] - 1, r - cells[-1][0]))\n\tif lo > 1:\n\t\tif dif == 0:\n\t\t\tprint(res[out])\n\t\telif dif == 1 and lo % 2 == 0:\n\t\t\tprint(res[not out])\n\t\telse:\n\t\t\tprint(res[True])\n\telif lo == 0:\n\t\tif hi == 0:\n\t\t\tprint(res[out])\n\t\telif hi == 1:\n\t\t\tprint(res[not out])\n\t\telse:\n\t\t\tprint(res[True])\n\telif lo == 1:\n\t\tif hi == 1:\n\t\t\tprint(res[out])\n\t\telse:\n\t\t\tprint(res[True])\n```"}]}, {"id": "TACO-19", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nRead problem statements in [Hindi], [Bengali], [Mandarin Chinese], [Russian], and [Vietnamese] as well.\n\nYou have become good friends with Chef. Right now, Chef is busy in the kitchen, so he asked you to solve a problem for him.\n\nConsider a list of integers $L$. Initially, $L$ contains the integers $1$ through $N$, each of them exactly once (but it may contain multiple copies of some integers later). The order of elements in $L$ is not important. You should perform the following operation $N-1$ times:\nChoose two elements of the list, let's denote them by $X$ and $Y$. These two elements may be equal.\nErase the chosen elements from $L$.\nAppend the number $X + Y + X \\cdot Y$ to $L$.\n\nAt the end, $L$ contains exactly one integer. Find the maximum possible value of this integer. Since the answer may be large, compute it modulo $1,000,000,007$ ($10^{9}+7$).\n\n------  Input ------\nThe first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\nThe first and only line of each test case contains a single integer $N$.\n\n------  Output ------\nFor each test case, print a single line containing one integer ― the maximum possible value of the final number in the list modulo $10^{9}+7$.\n\n------  Constraints ------\n$1 ≤ T ≤ 100,000$\n$1 ≤ N ≤ 1,000,000$\n\n------  Subtasks ------\nSubtask #1 (20 points): $1 ≤ T, N ≤ 25$ \n\nSubtask #2 (80 points): original constraints\n\n----- Sample Input 1 ------ \n3\n\n1\n\n2\n\n4\n----- Sample Output 1 ------ \n1\n\n5\n\n119\n----- explanation 1 ------ \nExample case 1: $L=[1]$\n\nExample case 2: $L=[1,2] \\rightarrow [1 + 2 + 1 \\cdot 2] $\n\nExample case 3: $L=[\\textbf{1},2,3,\\textbf{4}] \\rightarrow [\\textbf{2},3,\\textbf{9}] \\rightarrow [3,29] \\rightarrow [119] $. The chosen elements in each step are in bold.\n\nExample input:\n```\n3\n1\n2\n4\n```\n\nExpected output for the example input:\n```\n1\n5\n119\n```\n\nMetadata: Difficulty: MEDIUM | Time limit: 1 seconds | Memory limit: 50000 bytes | Source: https://www.codechef.com/problems/REDONE\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nl = []\np = 1\nfor i in range(1, 1000002):\n\tp = p * i % (10 ** 9 + 7)\n\tl.append(p - 1)\nfor tc in range(int(input())):\n\tprint(l[int(input())])\n```"}]}, {"id": "TACO-20", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nAs you know, an undirected connected graph with n nodes and n - 1 edges is called a tree. You are given an integer d and a tree consisting of n nodes. Each node i has a value a_{i} associated with it.\n\nWe call a set S of tree nodes valid if following conditions are satisfied: S is non-empty. S is connected. In other words, if nodes u and v are in S, then all nodes lying on the simple path between u and v should also be presented in S. $\\operatorname{max}_{u \\in S} a_{u} - \\operatorname{min}_{v \\in S} a_{v} \\leq d$.\n\nYour task is to count the number of valid sets. Since the result can be very large, you must print its remainder modulo 1000000007 (10^9 + 7).\n\n\n-----Input-----\n\nThe first line contains two space-separated integers d (0 ≤ d ≤ 2000) and n (1 ≤ n ≤ 2000).\n\nThe second line contains n space-separated positive integers a_1, a_2, ..., a_{n}(1 ≤ a_{i} ≤ 2000).\n\nThen the next n - 1 line each contain pair of integers u and v (1 ≤ u, v ≤ n) denoting that there is an edge between u and v. It is guaranteed that these edges form a tree.\n\n\n-----Output-----\n\nPrint the number of valid sets modulo 1000000007.\n\n\n-----Examples-----\nInput\n1 4\n2 1 3 2\n1 2\n1 3\n3 4\n\nOutput\n8\n\nInput\n0 3\n1 2 3\n1 2\n2 3\n\nOutput\n3\n\nInput\n4 8\n7 8 7 5 4 6 4 10\n1 6\n1 2\n5 8\n1 3\n3 5\n6 7\n3 4\n\nOutput\n41\n\n\n\n-----Note-----\n\nIn the first sample, there are exactly 8 valid sets: {1}, {2}, {3}, {4}, {1, 2}, {1, 3}, {3, 4} and {1, 3, 4}. Set {1, 2, 3, 4} is not valid, because the third condition isn't satisfied. Set {1, 4} satisfies the third condition, but conflicts with the second condition.\n\nExample input:\n```\n1 4\n2 1 3 2\n1 2\n1 3\n3 4\n```\n\nExpected output for the example input:\n```\n8\n```\n\nMetadata: Difficulty: HARD | Source: https://codeforces.com/problemset/problem/486/D\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nf = lambda : map(int, input().split())\nm = 1000000007\n(d, n) = f()\nt = list(f())\np = [[] for i in range(n)]\nfor j in range(n - 1):\n\t(u, v) = f()\n\tp[u - 1].append(v - 1)\n\tp[v - 1].append(u - 1)\n\ndef g(u, x, y):\n\ts = 1\n\tfor v in p[u]:\n\t\tif 0 < t[v] - t[y] <= d or (t[v] == t[y] and v > y):\n\t\t\tif v != x:\n\t\t\t\ts += s * g(v, u, y) % m\n\treturn s\nprint(sum((g(y, -1, y) for y in range(n))) % m)\n```"}]}, {"id": "TACO-21", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nA tree is an undirected connected graph without cycles.\n\nLet's consider a rooted undirected tree with n vertices, numbered 1 through n. There are many ways to represent such a tree. One way is to create an array with n integers p_1, p_2, ..., p_{n}, where p_{i} denotes a parent of vertex i (here, for convenience a root is considered its own parent). [Image] For this rooted tree the array p is [2, 3, 3, 2]. \n\nGiven a sequence p_1, p_2, ..., p_{n}, one is able to restore a tree:  There must be exactly one index r that p_{r} = r. A vertex r is a root of the tree.  For all other n - 1 vertices i, there is an edge between vertex i and vertex p_{i}. \n\nA sequence p_1, p_2, ..., p_{n} is called valid if the described procedure generates some (any) rooted tree. For example, for n = 3 sequences (1,2,2), (2,3,1) and (2,1,3) are not valid.\n\nYou are given a sequence a_1, a_2, ..., a_{n}, not necessarily valid. Your task is to change the minimum number of elements, in order to get a valid sequence. Print the minimum number of changes and an example of a valid sequence after that number of changes. If there are many valid sequences achievable in the minimum number of changes, print any of them.\n\n\n-----Input-----\n\nThe first line of the input contains an integer n (2 ≤ n ≤ 200 000) — the number of vertices in the tree.\n\nThe second line contains n integers a_1, a_2, ..., a_{n} (1 ≤ a_{i} ≤ n).\n\n\n-----Output-----\n\nIn the first line print the minimum number of elements to change, in order to get a valid sequence.\n\nIn the second line, print any valid sequence possible to get from (a_1, a_2, ..., a_{n}) in the minimum number of changes. If there are many such sequences, any of them will be accepted.\n\n\n-----Examples-----\nInput\n4\n2 3 3 4\n\nOutput\n1\n2 3 4 4 \n\nInput\n5\n3 2 2 5 3\n\nOutput\n0\n3 2 2 5 3 \n\nInput\n8\n2 3 5 4 1 6 6 7\n\nOutput\n2\n2 3 7 8 1 6 6 7\n\n\n\n-----Note-----\n\nIn the first sample, it's enough to change one element. In the provided output, a sequence represents a tree rooted in a vertex 4 (because p_4 = 4), which you can see on the left drawing below. One of other correct solutions would be a sequence 2 3 3 2, representing a tree rooted in vertex 3 (right drawing below). On both drawings, roots are painted red. [Image] \n\nIn the second sample, the given sequence is already valid.\n\nExample input:\n```\n4\n2 3 3 4\n```\n\nExpected output for the example input:\n```\n1\n2 3 4 4\n```\n\nMetadata: Difficulty: MEDIUM_HARD | Source: https://codeforces.com/problemset/problem/698/B\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\ninput()\nA = list(map(int, input().split(' ')))\nroot = -1\nfor (i, a) in enumerate(A):\n\tif i == a - 1:\n\t\troot = i\n\t\tbreak\nv = [False] * len(A)\nif root > -1:\n\tv[root] = True\nchanged = 0\nfor (i, a) in enumerate(A):\n\tif v[i]:\n\t\tcontinue\n\tv[i] = True\n\tl = [i]\n\ta -= 1\n\twhile not v[a]:\n\t\tl.append(a)\n\t\tv[a] = True\n\t\ta = A[a] - 1\n\tif a in l:\n\t\tif root == -1:\n\t\t\tA[a] = a + 1\n\t\t\troot = a\n\t\t\tchanged += 1\n\t\telse:\n\t\t\tA[a] = root + 1\n\t\t\tchanged += 1\nprint(changed)\nprint(' '.join(map(str, A)))\n```"}]}, {"id": "TACO-22", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nRead problem statements in [Hindi], [Bengali], [Mandarin Chinese], [Russian], and [Vietnamese] as well.\n\nIn Chefland, each citizen has their own personal string. Chef is no exception. Recently, his string broke and he went to a shop to get a new one.\n\nThere are two strings in the shop: $A$ and $B$. Chef may choose any substring $A_{s}$ of $A$ (possibly empty) and any substring $B_{s}$ of $B$ (also possibly empty). Then, the shop assistant cuts these substrings out and sells a single string $C = A_{s} + B_{s}$ (here, $+$ denotes string concatenation) to Chef. For example, if $A$ is \"aba\" and $B$ is \"cde\", then some of the strings Chef can buy are \"ba\", \"bac\", \"bacd\", \"ae\", \"d\", \"acde\", \"aba\", \"cde\" or \"abacde\".\n\nChef has seen a lot of strings in his life and he liked exactly $N$ of them (numbered $1$ through $N$). For each valid $i$, the $i$-th of these strings is denoted by $S_{i}$ and according to Chef, it has a *beauty* $b_{i}$. Let's denote the number of substrings of $C$ that are equal to $S_{i}$ by $cnt_{i}(C)$. If Chef buys a string $C$, he says that the *pleasure* he gets from this string is $\\sum_{i=1}^N cnt_{i}(C) \\cdot b_{i}$.\n\nWhat is the maximum possible pleasure Chef can get from a string he buys in the shop?\n\n------  Input ------\nThe first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\nThe first line of each test case contains a single string $A$.\nThe second line contains a single string $B$.\nThe third line contains a single integer $N$.\nThe following $N$ lines describe Chef's favourite strings. For each valid $i$, the $i$-th of these lines contains a string $S_{i}$, followed by a space and an integer $b_{i}$.\n\n------  Output ------\nFor each test case, print a single line containing one integer ― the maximum pleasure.\n\n------  Constraints ------\n$1 ≤ T ≤ 10$\n$1 ≤ |A|, |B| ≤ 10^{3}$\n$1 ≤ N ≤ 10^{4}$\n$1 ≤ |S_{i}| ≤ 26$ for each valid $i$\n$1 ≤ b_{i} ≤ 10^{5}$ for each valid $i$\n$A, B, S_{1}, S_{2}, \\ldots, S_{N}$ contain only lowercase English letters\n$S_{1}, S_{2}, \\ldots, S_{N}$ are pairwise distinct\nthe sum of $|A|$ over all test cases does not exceed $2 \\cdot 10^{3}$\nthe sum of $|B|$ over all test cases does not exceed $2 \\cdot 10^{3}$\nthe sum of $N$ over all test cases does not exceed $2 \\cdot 10^{4}$\n\n------  Subtasks ------\nSubtask #1 (20 points, time limit 2 seconds): $|A|, |B|, N ≤ 100$\n\nSubtask #2 (30 points, time limit 1 second):\nthe sum of $|A|$ over all test cases does not exceed $500$\nthe sum of $|B|$ over all test cases does not exceed $500$\n\nSubtask #3 (50 points, time limit 1 second): original constraints\n\n----- Sample Input 1 ------ \n1\n\nhitech\n\ncodechef\n\n3\n\nchef 3\n\ncode 1\n\neche 5\n----- Sample Output 1 ------ \n13\n----- explanation 1 ------ \nExample case 1: Chef can buy the string $C$ = \"tech\" + \"echef\" = \"techechef\". In this string $C$, one substring is \"chef\", there are no substrings \"code\" and two substrings are \"eche\". Chef's pleasure in this case is $1 \\cdot 3 + 0 \\cdot 1 + 2 \\cdot 5 = 13$, which is the maximum possible pleasure.\n\nExample input:\n```\n1\nhitech\ncodechef\n3\nchef 3\ncode 1\neche 5\n```\n\nExpected output for the example input:\n```\n13\n```\n\nMetadata: Difficulty: VERY_HARD | Time limit: 1 - 2 seconds | Memory limit: 50000 bytes | Source: https://www.codechef.com/problems/TWOSTRS\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nfrom sys import stdin, stdout\nT = int(stdin.readline())\n\ndef presuf(pre, suf):\n\tfor s in bts:\n\t\tfor i in range(len(s) - 1):\n\t\t\t(pre[s[:i + 1]], suf[s[len(s) - i - 1:]]) = (True, True)\n\treturn (pre, suf)\nfor _ in range(T):\n\ta = stdin.readline().strip('\\n')\n\tna = len(a)\n\tb = stdin.readline().strip('\\n')\n\tnb = len(b)\n\tA = [0] * (na + 1)\n\tB = [0] * (nb + 1)\n\t(n, bts, AB) = (int(stdin.readline()), {}, [[0 for i in range(nb + 1)] for j in range(na + 1)])\n\tfor i in range(n):\n\t\t(s, bt) = stdin.readline().split(' ')\n\t\tbt = int(bt)\n\t\tbts[s] = bt\n\t(pre, suf) = presuf({}, {})\n\tAs = {}\n\tdone = {}\n\tfor k in range(min(26, na), 0, -1):\n\t\tfor i in range(na, k - 1, -1):\n\t\t\ts = a[i - k:i]\n\t\t\tif s in bts:\n\t\t\t\tA[i] += bts[s]\n\t\t\tif s not in pre:\n\t\t\t\tcontinue\n\t\t\tif i in done:\n\t\t\t\tdel pre[s]\n\t\t\t\tcontinue\n\t\t\tfor j in range(k):\n\t\t\t\tif s[k - j - 1:] not in As:\n\t\t\t\t\tAs[s[k - j - 1:]] = []\n\t\t\t\tAs[s[k - j - 1:]].append(i)\n\t\t\t\tdone[i] = True\n\t\t\tdel pre[s]\n\t(Bs, done, mx) = ({}, {}, 0)\n\tfor k in range(min(26, nb), 0, -1):\n\t\tfor i in range(nb - k + 1):\n\t\t\ts = b[i:i + k]\n\t\t\tif s in bts:\n\t\t\t\tB[i + 1] += bts[s]\n\t\t\tif s not in suf:\n\t\t\t\tcontinue\n\t\t\tif i in done:\n\t\t\t\tdel suf[s]\n\t\t\t\tcontinue\n\t\t\tfor j in range(k):\n\t\t\t\tif s[:j + 1] not in Bs:\n\t\t\t\t\tBs[s[:j + 1]] = []\n\t\t\t\tBs[s[:j + 1]].append(i + 1)\n\t\t\t\tdone[i] = True\n\t\t\tdel suf[s]\n\tfor i in range(1, na + 1, 1):\n\t\tA[i] = A[i] + A[i - 1]\n\tfor i in range(nb - 1, -1, -1):\n\t\tB[i] = B[i] + B[i + 1]\n\tfor s in bts:\n\t\tfor i in range(1, len(s)):\n\t\t\tst = s[:i]\n\t\t\ten = s[i:]\n\t\t\tbt = bts[s]\n\t\t\tif st in As and en in Bs:\n\t\t\t\tfor x in As[st]:\n\t\t\t\t\tfor y in Bs[en]:\n\t\t\t\t\t\tAB[x][y] += bt\n\tfor i in range(na + 1):\n\t\tfor j in range(nb + 1):\n\t\t\tmx = max(A[i] + B[j] + AB[i][j], mx)\n\tprint(mx)\n```"}]}, {"id": "TACO-23", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nStack has a positive integer P(P > 1).  \nHe starts a game where his initial score is 0.\n\nIn the i^{th} turn, with a probability of \\frac{1}{2}, Stack adds \\frac{1}{P^{i-1}} to his score. \n \nStack stops after N turns.\n\nLet S_{i} be his score after i turns and F(i) denote the [expected value] of S_{i}^{2}. \n\nFor each integer i(1 ≤ i ≤ N), find the value of F(i) modulo 998244353. \n\n------ Input Format ------ \n\nThe only line of input contains two space-separated positive integers N and P, as mentioned in the statement.\n\n------ Output Format ------ \n\nPrint N space-separated integers. For each integer i(1 ≤ i ≤ N), output the value of F(i) modulo 998244353. \n\nFormally, let M=998244353. It can be shown that the answer can be expressed as an irreducible fraction \\frac{x}{y}, where x and y are integers and y \\not \\equiv 0 \\pmod{M}.  \nOutput the integer equal to x \\cdot y^{-1} \\bmod M .  \nIn other words, output such an integer z that 0 ≤ z < M and z \\cdot y \\equiv x \\pmod{M}.\n.\n\n------ Constraints ------ \n\n$1 ≤ N ≤ 3 \\cdot 10^{5}$\n$2 ≤ P ≤ 10^{5}$\n\n----- Sample Input 1 ------ \n2 2\n\n----- Sample Output 1 ------ \n499122177 124780545\n\n----- explanation 1 ------ \n$S_{1}$ can be $0$ or $1$ with equal probability.\nThus $F(1)=\\frac{0 \\cdot 0}{2}+\\frac{1 \\cdot 1}{2} = \\frac{1}{2}$.\n\n$F(2)=\\frac{7}{8}$.\n\n----- Sample Input 2 ------ \n10 343\n\n----- Sample Output 2 ------ \n499122177 379526990 822885144 761122022 256959043 151932103 340445396 758502677 478338987 125853909\n\n----- explanation 2 ------\n\nExample input:\n```\n2 2\n```\n\nExpected output for the example input:\n```\n499122177 124780545\n```\n\nMetadata: Difficulty: HARD | Time limit: 2 seconds | Memory limit: 50000 bytes | Source: https://www.codechef.com/problems/EXPVALUE\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nmod = 998244353\n(n, p) = map(int, input().split())\nr = pow(2, -1, mod)\nx = pow(p, -1, mod)\nm = 0\na = 1\nprint(r, end=' ')\nfor i in range(n - 1):\n\tm += pow(x, i, mod)\n\ta = x * a % mod\n\tr += a * pow(2, -1, mod) * m + pow(a, 2, mod) * pow(2, -1, mod)\n\tr = r % mod\n\tprint(r, end=' ')\n```"}]}, {"id": "TACO-24", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\n_\"I hide in plain sight, just as you\"_.\n\nGus Fring has earned a huge profit from Los Pollos Hermanos and he wishes to celebrate. He loves watching horse-riding, hence he bought $N$ horses.\nOne day he organizes a horse-riding competition to celebrate the deal with Don Eladio.\n\nThere are $N$ horses taking part in the competition with speeds of $A$_{$1$}$,$ $A$_{$2$}$,$ $...,$ $A$_{$N$} respectively. It is given that all speeds are distinct.\n\nMultiple races are being conducted and it is not mandatory for each horse to participate in every race.\n\nFor the $i$^{$th$} horse, find the number of subsets with size $≥$ $2$ such that if a race were to be conducted between horses in this subset then the $i$^{$th$} horse would finish in the top three.\n\nFor subsets of size 2 the runner should finish either 1st or 2nd. There is no 3rd position when the size of the subset is 2.\n\nSince the answer might be quite large, compute it, modulo $1000000007$ $(10^{9}+7)$.\n\n------ Input: ------\n\nFirst line will contain $T$, number of testcases. Then the testcases follow. \nFirst line of each testcase contains of a single integer $N$ denoting the number of horses.\nThe second line of each testcase contains $N$ space-separated integers $A$_{$1$}$,$ $A$_{$2$}$,$ $...,$$A$_{$N$}, denoting the speeds of the horses. \n\n------ Output: ------\nFor each testcase, output a single line containing $N$ space separated integers , where the $i$^{$th$} integer denotes the number of subsets of size $≥$ $2$ modulo $(10^{9}+7)$, such that the $i$^{$th$} horse finishes in the top three.\n\n------ Constraints  ------\n$1 ≤ T ≤ 5000$\n$2 ≤ N ≤ 10^{5}$\n$1 ≤ A[i] ≤ 10^{9}$\nAll speeds are distinct\nSum of N over all test cases does not exceed $5*10^{5}$\n\n----- Sample Input 1 ------ \n\t1\n\t4\n4 2 3 1\n----- Sample Output 1 ------ \n\t7 7 7 6\n----- explanation 1 ------ \nFor the 1st horse the 7 subsets are-  $ [4,2,3,1],[4,2,3],[4,2,1],[4,3,1],[4,2],[4,1],[4,3]$  \nFor the 2nd horse the subsets are-  $[4,2,3,1],[4,2,3],[4,2,1],[2,3,1],[2,4],[2,1],[2,3]$ \nFor the 3rd horse the subsets are-  $[4,2,3,1],[4,2,3],[3,2,1],[4,3,1],[3,2],[3,1],[4,3]$ \nFor the 4th horse the subsets are-  $[1,2,3],[4,2,1],[4,3,1],[1,2],[4,1],[1,3]$\n\nExample input:\n```\n1\n4\n    4 2 3 1\n```\n\nExpected output for the example input:\n```\n7 7 7 6\n```\n\nMetadata: Difficulty: HARD | Time limit: 1 seconds | Memory limit: 50000 bytes | Source: https://www.codechef.com/problems/RRUN\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nimport sys\ninput = sys.stdin.readline\n(inp, ip) = (lambda : int(input()), lambda : [int(w) for w in input().split()])\nM = 10 ** 9 + 7\nfor _ in range(inp()):\n\tn = inp()\n\tx = ip()\n\tind = {x[i]: i for i in range(n)}\n\tx.sort()\n\tans = [0] * n\n\tfor i in range(n):\n\t\tans[ind[x[i]]] = (pow(2, i, M) * ((n - i) * (n - i - 1) // 2 + 1) - 1) % M\n\tprint(*ans)\n```"}]}, {"id": "TACO-25", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nThere is a building with 10^{9} floors labelled 1 to 10^{9} from the bottom to the top. N people would like to move up several floors in the building. Specifically, the i-th person wants to move from floor A_{i} to floor B_{i}, where A_{i} < B_{i}.\n\nThere are M elevators in the building. An elevator can hold any number of people. Initially, at the 0-th second, all elevators are at floor 1. \n\nAn elevator takes 1 second to move up 1 floor but cannot move down any floors. On any floor, an elevator may stop so that people may enter or exit the elevator. Each person takes H seconds to enter or exit an elevator. Two or more people cannot enter or exit the same elevator at the same time; they must wait for their turn. \n\nA person can exit an elevator on any floor, not only floor B_{i}. In particular, a person can switch elevators by exiting on some floor and entering a different elevator on the same floor.\n\nWe say that the i-th person has reached the destination after taking H seconds to exit an elevator at floor B_{i}. \n\nFind the minimum time needed in seconds until all N people have reached their destinations if they enter and exit elevators optimally.\n\n*Note: We would recommend Python users to use PYPY/PYPY3 instead of PYTHON/PYTHON3.*\n\n------ Input Format ------ \n\n- The first line contains a single integer T — the number of test cases. Then the test cases follow.\n- The first line of each test case contains three integers N, M and H — the number of people, the number of elevators and the time taken for a person to enter or exit an elevator.\n- N lines follow. The i-th line contains two integers A_{i} and B_{i}, where the i-th person wants to move from floor A_{i} to floor B_{i}.\n\n------ Output Format ------ \n\nFor each test case, output a single integer on a new line, representing the minimum time needed until all N people have reached their destinations.\n\n------ Constraints ------ \n\n$1 ≤T ≤10^{5}$\n$1 ≤N, M ≤3 \\cdot 10^{5}$\n$1 ≤H ≤10^{9}$\n$1 ≤A_{i} < B_{i} ≤10^{9}$\n- The sum of $N$ over all test cases will not exceed $3 \\cdot 10^{5}$\n- The sum of $M$ over all test cases will not exceed $3 \\cdot 10^{5}$\n\n----- Sample Input 1 ------ \n3\n5 3 2\n12 24\n2 3\n5 6\n3 8\n5 11\n1 20 23\n20 23\n6 3 998244353\n3 9\n3 9\n3 9\n3 9\n3 9\n3 9\n\n----- Sample Output 1 ------ \n27\n68\n3992977420\n\n----- explanation 1 ------ \nFor the first test case, a possible sequence of events is given as follows for each elevator.\n\nElevator $1$:\n\n- At the $0$-th second, elevator $1$ starts moving up from floor $1$.\n- At the $2$-nd second, elevator $1$ stops at floor $3$. Person $4$ starts entering elevator $1$.\n- At the $4$-th second, person $4$ finishes entering elevator $1$. Elevator $1$ continues moving up from floor $3$.\n- At the $6$-th second, elevator $1$ stops at floor $5$. Person $4$ starts exiting elevator $1$.\n- At the $8$-th second, person $4$ finishes exiting elevator $1$. Elevator $1$ continues moving up from floor $5$.\n\nElevator $2$:\n\n- At the $0$-th second, elevator $2$ starts moving up from floor $1$.\n- At the $1$-st second, elevator $2$ stops at floor $2$. Person $2$ starts entering elevator $2$.\n- At the $3$-rd second, person $2$ finishes entering elevator $2$. Elevator $2$ continues moving up from floor $2$.\n- At the $4$-th second, elevator $2$ stops at floor $3$. Person $2$ starts exiting elevator $2$.\n- At the $6$-th second, person $2$ finishes exiting elevator $2$. Elevator $2$ continues moving up from floor $3$.\n- At the $8$-th second, elevator $2$ stops at floor $5$. Person $4$ starts entering elevator $2$.\n- At the $10$-th second, person $4$ finishes entering elevator $2$. Person $3$ starts entering elevator $2$.\n- At the $12$-th second, person $3$ finishes entering elevator $2$. Person $5$ starts entering elevator $2$.\n- At the $14$-th second, person $5$ finishes entering elevator $2$. Elevator $2$ continues moving up from floor $5$.\n- At the $15$-th second, elevator $2$ stops at floor $6$. Person $3$ starts exiting elevator $2$.\n- At the $17$-th second, person $3$ finishes exiting elevator $2$. Elevator $2$ continues moving up from floor $6$.\n- At the $19$-th second, elevator $2$ stops at floor $8$. Person $4$ starts exiting elevator $2$.\n- At the $21$-st second, person $4$ finishes exiting elevator $2$. Elevator $2$ continues moving up from floor $8$.\n- At the $24$-th second, elevator $2$ stops at floor $11$. Person $5$ starts exiting elevator $2$.\n- At the $26$-th second, person $5$ finishes exiting elevator $2$. Elevator $2$ continues moving up from floor $11$.\n\nElevator $3$:\n\n- At the $0$-th second, elevator $3$ starts moving up from floor $1$.\n- At the $11$-th second, elevator $3$ stops at floor $12$. Person $1$ starts entering elevator $3$.\n- At the $13$-th second, person $1$ finishes entering elevator $3$. Elevator $3$ continues moving up from floor $12$.\n- At the $25$-th second, elevator $3$ stops at floor $24$. Person $1$ starts exiting elevator $3$.\n- At the $27$-th second, person $1$ finishes exiting elevator $3$. Elevator $3$ continues moving up from floor $24$.\n\nAll people reach their destinations by $27$ seconds. Notice that person $4$ switched elevators, which is allowed. It can be shown that there is no way for them to reach their destinations by $26$ seconds or fewer.\n\nExample input:\n```\n3\n5 3 2\n12 24\n2 3\n5 6\n3 8\n5 11\n1 20 23\n20 23\n6 3 998244353\n3 9\n3 9\n3 9\n3 9\n3 9\n3 9\n```\n\nExpected output for the example input:\n```\n27\n68\n3992977420\n```\n\nMetadata: Difficulty: VERY_HARD | Time limit: 2 seconds | Memory limit: 50000 bytes | Source: https://www.codechef.com/problems/ELEVATORS\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\ndef sim(b, n, m, h, x):\n\tNeed = 0\n\tLimit = b[0] - 1 + 2 * h\n\tif Limit > x:\n\t\treturn False\n\tfor i in range(1, n):\n\t\tif Limit + 2 * h <= x:\n\t\t\tLimit += 2 * h\n\t\telse:\n\t\t\tLimit = b[i] - 1 + 2 * h\n\t\t\tNeed += 1\n\treturn Need < m\nfor _ in range(int(input())):\n\t(n, m, h) = map(int, input().split())\n\tb = []\n\tfor _ in range(n):\n\t\t(ai, bi) = map(int, input().split())\n\t\tb.append(bi)\n\tb.sort(reverse=True)\n\t(lo, hi) = (0, 10 ** 15)\n\twhile lo < hi:\n\t\tmid = (lo + hi) // 2\n\t\tif sim(b, n, m, h, mid):\n\t\t\thi = mid\n\t\telse:\n\t\t\tlo = mid + 1\n\tprint(lo)\n```"}]}, {"id": "TACO-26", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nChef prepared two dishes yesterday. Chef had assigned the \\textbf{tastiness} T_{1} and T_{2} to the first and to the second dish respectively. The tastiness of the dishes can be any \\textbf{integer} between 0 and N (both inclusive).\n\nUnfortunately, Chef has forgotten the values of T_{1} and T_{2} that he had assigned to the dishes. However, he remembers the sum of the tastiness of both the dishes - denoted by S.\n\nChef wonders, what can be the maximum possible absolute difference between the tastiness of the two dishes. Can you help the Chef in finding the maximum absolute difference?\n\nIt is guaranteed that at least one pair \\{T_{1}, T_{2}\\} exist such that T_{1} + T_{2} = S, 0 ≤ T_{1}, T_{2} ≤ N.\n\n------ Input Format ------ \n\n- The first line of input contains a single integer T, denoting the number of testcases. The description of the T testcases follows.\n- The first and only line of each test case contains two space-separated integers N, S, denoting the maximum tastiness and the sum of tastiness of the two dishes, respectively.\n\n------ Output Format ------ \n\nFor each testcase, output a single line containing the maximum absolute difference between the tastiness of the two dishes.\n\n------ Constraints ------ \n\n$1 ≤ T ≤ 10^{3}$\n$1 ≤ N ≤ 10^{5}$\n$1 ≤ S ≤ 2 \\cdot 10^{5}$\n\n----- Sample Input 1 ------ \n3\n3 1\n4 4\n2 3\n----- Sample Output 1 ------ \n1\n4\n1\n----- explanation 1 ------ \nTest Case $1$: The possible pairs of $\\{T_{1}, T_{2}\\}$ are $\\{0, 1\\}$ and $\\{1, 0\\}$. Difference in both the cases is $1$, hence the maximum possible absolute difference is $1$.\n\nTest Case $2$: The possible pairs of $\\{T_{1}, T_{2}\\}$ are $\\{0, 4\\}$, $\\{1, 3\\}$, $\\{2, 2\\}$, $\\{3, 1\\}$ and $\\{4, 0\\}$. The maximum possible absolute difference is $4$.\n\nTest Case $3$: The possible pairs of $\\{T_{1}, T_{2}\\}$ are $\\{1, 2\\}$ and $\\{2, 1\\}$. Difference in both the cases is $1$, and hence the maximum possible absolute difference is $1$.\n\nExample input:\n```\n3\n3 1\n4 4\n2 3\n```\n\nExpected output for the example input:\n```\n1\n4\n1\n```\n\nMetadata: Difficulty: EASY | Time limit: 0.5 seconds | Memory limit: 50000 bytes | Source: https://www.codechef.com/problems/MAX_DIFF\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nfor i in range(int(input())):\n\t(n, s) = map(int, input().split())\n\tprint(abs(n - abs(n - s)))\n```"}]}, {"id": "TACO-27", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nNiwel is a little golden bear. As everyone knows, bears live in forests, but Niwel got tired of seeing all the trees so he decided to move to the city.\n\nIn the city, Niwel took on a job managing bears to deliver goods. The city that he lives in can be represented as a directed graph with n nodes and m edges. Each edge has a weight capacity. A delivery consists of a bear carrying weights with their bear hands on a simple path from node 1 to node n. The total weight that travels across a particular edge must not exceed the weight capacity of that edge.\n\nNiwel has exactly x bears. In the interest of fairness, no bear can rest, and the weight that each bear carries must be exactly the same. However, each bear may take different paths if they like.\n\nNiwel would like to determine, what is the maximum amount of weight he can deliver (it's the sum of weights carried by bears). Find the maximum weight.\n\n\n-----Input-----\n\nThe first line contains three integers n, m and x (2 ≤ n ≤ 50, 1 ≤ m ≤ 500, 1 ≤ x ≤ 100 000) — the number of nodes, the number of directed edges and the number of bears, respectively.\n\nEach of the following m lines contains three integers a_{i}, b_{i} and c_{i} (1 ≤ a_{i}, b_{i} ≤ n, a_{i} ≠ b_{i}, 1 ≤ c_{i} ≤ 1 000 000). This represents a directed edge from node a_{i} to b_{i} with weight capacity c_{i}. There are no self loops and no multiple edges from one city to the other city. More formally, for each i and j that i ≠ j it's guaranteed that a_{i} ≠ a_{j} or b_{i} ≠ b_{j}. It is also guaranteed that there is at least one path from node 1 to node n.\n\n\n-----Output-----\n\nPrint one real value on a single line — the maximum amount of weight Niwel can deliver if he uses exactly x bears. Your answer will be considered correct if its absolute or relative error does not exceed 10^{ - 6}.\n\nNamely: let's assume that your answer is a, and the answer of the jury is b. The checker program will consider your answer correct if $\\frac{|a - b|}{\\operatorname{max}(1, b)} \\leq 10^{-6}$.\n\n\n-----Examples-----\nInput\n4 4 3\n1 2 2\n2 4 1\n1 3 1\n3 4 2\n\nOutput\n1.5000000000\n\nInput\n5 11 23\n1 2 3\n2 3 4\n3 4 5\n4 5 6\n1 3 4\n2 4 5\n3 5 6\n1 4 2\n2 5 3\n1 5 2\n3 2 30\n\nOutput\n10.2222222222\n\n\n\n-----Note-----\n\nIn the first sample, Niwel has three bears. Two bears can choose the path $1 \\rightarrow 3 \\rightarrow 4$, while one bear can choose the path $1 \\rightarrow 2 \\rightarrow 4$. Even though the bear that goes on the path $1 \\rightarrow 2 \\rightarrow 4$ can carry one unit of weight, in the interest of fairness, he is restricted to carry 0.5 units of weight. Thus, the total weight is 1.5 units overall. Note that even though Niwel can deliver more weight with just 2 bears, he must use exactly 3 bears on this day.\n\nExample input:\n```\n4 4 3\n1 2 2\n2 4 1\n1 3 1\n3 4 2\n```\n\nExpected output for the example input:\n```\n1.5000000000\n```\n\nMetadata: Difficulty: HARD | Source: https://codeforces.com/problemset/problem/653/D\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nfrom collections import defaultdict, deque\nadj = defaultdict(lambda : defaultdict(lambda : 0))\n\ndef bfs(graph, inicio, destino, parent):\n\tparent.clear()\n\tqueue = deque()\n\tqueue.append([inicio, float('Inf')])\n\tparent[inicio] = -2\n\twhile len(queue):\n\t\t(current, flow) = queue.popleft()\n\t\tfor i in adj[current]:\n\t\t\tif parent[i] == -1 and graph[current][i] > 0:\n\t\t\t\tparent[i] = current\n\t\t\t\tflow = min(flow, graph[current][i])\n\t\t\t\tif i == destino:\n\t\t\t\t\treturn flow\n\t\t\t\tqueue.append((i, flow))\n\treturn 0\n\ndef maxflow(graph, inicio, destino):\n\tflow = 0\n\tparent = defaultdict(lambda : -1)\n\twhile True:\n\t\tt = bfs(graph, inicio, destino, parent)\n\t\tif t:\n\t\t\tflow += t\n\t\t\tcurrent = destino\n\t\t\twhile current != inicio:\n\t\t\t\tprev = parent[current]\n\t\t\t\tgraph[prev][current] -= t\n\t\t\t\tgraph[current][prev] += t\n\t\t\t\tcurrent = prev\n\t\telse:\n\t\t\tbreak\n\treturn flow\n(n, m, x) = [int(i) for i in input().split()]\nfor _ in range(m):\n\tt = [int(i) for i in input().split()]\n\tadj[t[0]][t[1]] = t[2]\n\ndef check(k):\n\tmeh = defaultdict(lambda : defaultdict(lambda : 0))\n\tfor i in adj:\n\t\tfor j in adj[i]:\n\t\t\tww = adj[i][j] // k\n\t\t\tmeh[i][j] = ww\n\tflow = maxflow(meh, 1, n)\n\treturn flow\nlo = 1 / x\nhi = check(1)\nfor _ in range(70):\n\tmid = (hi + lo) / 2\n\tif hi - lo < 1e-10:\n\t\tbreak\n\tif check(mid) >= x:\n\t\tlo = mid\n\telse:\n\t\thi = mid\nprint(format(lo * x, '.9f'))\n```"}]}, {"id": "TACO-28", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nRead problems statements in Mandarin Chinese  and Russian. \n\nChef passed all the exams. This month was really tiring. So, he decided to relax for a little bit. Well, there is no better way to relax than to play with sets of numbers.\n\nChef loves to solve problems about sets. That does not mean that he is any good at it. Anyway, he opened his favorite problemset archive, and there he found a task that he thinks is best suited to him. \n\n------ Problem description ------ \n\nYou are given N sets and Q queries. Initially, each set consists only of a single element. The sets are indexed from 1 to N, and the i^{th} set contains the number i. Each query may be one of the following two types.\n\nUNION a b - merge the a^{th} and the b^{th}. The new set will hold the index N + number of union operations before this one + 1. Also, after this operation, the a^{th} set and the b^{th} set will no longer exist.\nGET a k - find the k^{th} smallest element in the set indexed a\n\nPlease help our dear Chef! :)\n\n------ Input ------ \n\nThe first line of the input contains two integers N and Q denoting the number of sets in the very beginning and the number of queries. Each of the next Q lines contains one query per line - either UNION a b\" or GET a k.\n\n------ Output ------ \n\nFor each query of second type (i.e. GET) output the number that you've found.\n\n------ Constraints ------ \n\n$1 ≤ N ≤ 10^{5}$\n$1 ≤ Q ≤ 2 * 10^{5}.$\n$All the queries are valid, that is, for any query GET i p, the i^{th} set exists, and has a size of at least p; and for any query UNION a b, the sets indexed as a as well as b exist.$\n$Subtask 1 (35 points): 1 ≤ N, Q ≤ 500$\n$Subtask 2 (65 points): 1 ≤ N ≤ 10^{5}, 1 ≤ Q ≤ 2 * 10^{5}$\n\n------ Example ------ \n\nInput:\n7 8\nUNION 1 2\nUNION 8 3\nGET 4 1\nUNION 4 5\nGET 10 2\nGET 9 3\nGET 9 2\nGET 9 1\n\nOutput:\n4\n5\n3\n2\n1\n\n------ Explanation ------ \n\n$Initially, the sets are: {1}, {2}, {3}, {4}, {5}, {6}, {7}.$\n$After the first query: {}, {}, {3}, {4}, {5}, {6}, {7}, {1, 2}. $\n$After the second query the configuration of sets is: {}, {}, {}, {4}, {5}, {6}, {7}, {}, {1, 2, 3}.$\n$The third query: the set {4} contains only one number so the answer is 4$\n$The configuration of sets after the fourth query: {}, {}, {}, {}, {}, {6}, {7}, {}, {1, 2, 3}, {4, 5}$\n$The fifth query: the second smallest element in {4, 5} is 5.$\n$For queries 6, 7, 8, the set is {1, 2, 3}. $\n\nExample input:\n```\n7 8\nUNION 1 2\nUNION 8 3\nGET 4 1\nUNION 4 5\nGET 10 2\nGET 9 3\nGET 9 2\nGET 9 1\n```\n\nExpected output for the example input:\n```\n4\n5\n3\n2\n1\n```\n\nMetadata: Difficulty: VERY_HARD | Time limit: 1 seconds | Memory limit: 50000 bytes | Source: https://www.codechef.com/problems/CHEFDTRE\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nfrom bisect import insort_left\n(n, q) = map(int, input().split(' '))\na = [[i] for i in range(1, n + 1)]\nwhile q > 0:\n\tinp = input().split(' ')\n\tx = int(inp[1]) - 1\n\ty = int(inp[2]) - 1\n\tif inp[0] == 'UNION':\n\t\tif len(a[x]) > len(a[y]):\n\t\t\ta.append(a[x])\n\t\t\tfor j in a[y]:\n\t\t\t\tinsort_left(a[x], j)\n\t\telse:\n\t\t\ta.append(a[y])\n\t\t\tfor j in a[x]:\n\t\t\t\tinsort_left(a[y], j)\n\t\ta[x] = a[y] = 0\n\telif inp[0] == 'GET':\n\t\tprint(a[x][y])\n\tq -= 1\n```"}]}, {"id": "TACO-29", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nMark is an undergraduate student and he is interested in rotation. A conveyor belt competition is going on in the town which Mark wants to win. In the competition, there's A conveyor belt which can be represented as a strip of 1xN blocks. Each block has a number written  on it. The belt keeps rotating in such a way that after each rotation, each block is shifted to left of it and the first block goes to last position.  \n\nThere is a switch near the conveyer belt which can stop the belt. Each participant would be given a single chance to stop the belt and his PMEAN would be calculated.  \n\nPMEAN is calculated using the sequence which is there on the belt when it stops. The participant having highest PMEAN is the winner. There can be multiple winners.\n\nMark wants to be among the winners. What PMEAN he should try to get which guarantees him to be the winner.\n\n$\\textit{PMEAN}=\\sum_{i=1}^{n}i\\times a[i]$\n\nwhere ${a}$ represents the configuration of conveyor belt when it is stopped. Indexing starts from 1.  \n\nInput Format \n\nFirst line contains N denoting the number of elements on the belt. \n\nSecond line contains N space separated integers.  \n\nOutput Format \n\nOutput the required PMEAN  \n\nConstraints \n\n1 ≤ N ≤ 10^{6} \n\n-10^{9} ≤ each number ≤ 10^{9} \n\nFor any rotation, PMEAN will always lie within the range of 64-bit signed integer.  \n\nSample Input  \n\n3\n20 30 10 \n\nSample Output  \n\n140\n\nExplanation  \n\nNumber on top can be written in these manners. \n\nInitial numbers on belt, 20 30 10  PMEAN = 1x20 + 2x30 + 3x10 = 110 \n\nAfter first rotation,     30 10 20  PMEAN = 1x30 + 2x10 + 3x20 = 110 \n\nAfter second rotation,     10 20 30  PMEAN = 1x10 + 2x20 + 3x30 = 140 \n\nSo maximum possible value will be 140.\n\nExample input:\n```\n3\n20 30 10\n```\n\nExpected output for the example input:\n```\n140\n```\n\nMetadata: Difficulty: MEDIUM | Source: https://www.hackerrank.com/challenges/game-of-rotation/problem\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\ninput()\na = list(map(int, input().split()))\nn = len(a)\ns = sum(a)\np = [sum(((i + 1) * a[i] for i in range(n)))]\nfor i in range(n - 1):\n\tp.append(p[i] + n * a[i] - s)\nprint(max(p))\n```"}]}, {"id": "TACO-30", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nA sportsman starts from point x_{start} = 0 and runs to point with coordinate x_{finish} = m (on a straight line). Also, the sportsman can jump — to jump, he should first take a run of length of not less than s meters (in this case for these s meters his path should have no obstacles), and after that he can jump over a length of not more than d meters. Running and jumping is permitted only in the direction from left to right. He can start andfinish a jump only at the points with integer coordinates in which there are no obstacles. To overcome some obstacle, it is necessary to land at a point which is strictly to the right of this obstacle.\n\nOn the way of an athlete are n obstacles at coordinates x_1, x_2, ..., x_{n}. He cannot go over the obstacles, he can only jump over them. Your task is to determine whether the athlete will be able to get to the finish point.\n\n\n-----Input-----\n\nThe first line of the input containsd four integers n, m, s and d (1 ≤ n ≤ 200 000, 2 ≤ m ≤ 10^9, 1 ≤ s, d ≤ 10^9) — the number of obstacles on the runner's way, the coordinate of the finishing point, the length of running before the jump and the maximum length of the jump, correspondingly.\n\nThe second line contains a sequence of n integers a_1, a_2, ..., a_{n} (1 ≤ a_{i} ≤ m - 1) — the coordinates of the obstacles. It is guaranteed that the starting and finishing point have no obstacles, also no point can have more than one obstacle, The coordinates of the obstacles are given in an arbitrary order.\n\n\n-----Output-----\n\nIf the runner cannot reach the finishing point, print in the first line of the output \"IMPOSSIBLE\" (without the quotes).\n\nIf the athlete can get from start to finish, print any way to do this in the following format:  print a line of form \"RUN X>\" (where \"X\" should be a positive integer), if the athlete should run for \"X\" more meters;  print a line of form \"JUMP Y\" (where \"Y\" should be a positive integer), if the sportsman starts a jump and should remain in air for \"Y\" more meters. \n\nAll commands \"RUN\" and \"JUMP\" should strictly alternate, starting with \"RUN\", besides, they should be printed chronologically. It is not allowed to jump over the finishing point but it is allowed to land there after a jump. The athlete should stop as soon as he reaches finish.\n\n\n-----Examples-----\nInput\n3 10 1 3\n3 4 7\n\nOutput\nRUN 2\nJUMP 3\nRUN 1\nJUMP 2\nRUN 2\n\nInput\n2 9 2 3\n6 4\n\nOutput\nIMPOSSIBLE\n\nExample input:\n```\n3 10 1 3\n3 4 7\n```\n\nExpected output for the example input:\n```\nRUN 2\nJUMP 3\nRUN 1\nJUMP 2\nRUN 2\n```\n\nMetadata: Difficulty: MEDIUM_HARD | Source: https://codeforces.com/problemset/problem/637/D\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nf = lambda : map(int, input().split())\n(n, m, s, d) = f()\n(p, x, z) = ([], -1, 1)\nfor y in sorted(f()) + [m + 1]:\n\tif y - x > s + 1 or y > m or x < 0:\n\t\tu = x - z + 2\n\t\tv = y - x - 2\n\t\tif u > d or (v < s and x < 0):\n\t\t\tp = ['IMPOSSIBLE']\n\t\t\tbreak\n\t\tif u:\n\t\t\tp += ['JUMP ' + str(u)]\n\t\tif v:\n\t\t\tp += ['RUN ' + str(v)]\n\t\tz = y\n\tx = y\nprint('\\n'.join(p))\n```"}]}, {"id": "TACO-31", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nYou are developing a new feature for the website which sells airline tickets: being able to sort tickets by price! You have already extracted the tickets' prices, so there's just the last step to be done...\n\nYou are given an array of integers. Sort it in non-descending order.\n\n\n-----Input-----\n\nThe input consists of a single line of space-separated integers. The first number is n (1 ≤ n ≤ 10) — the size of the array. The following n numbers are the elements of the array (1 ≤ a_{i} ≤ 100).\n\n\n-----Output-----\n\nOutput space-separated elements of the sorted array.\n\n\n-----Example-----\nInput\n3 3 1 2\n\nOutput\n1 2 3 \n\n\n\n-----Note-----\n\nRemember, this is a very important feature, and you have to make sure the customers appreciate it!\n\nExample input:\n```\n3 3 1 2\n```\n\nExpected output for the example input:\n```\n1 2 3\n```\n\nMetadata: Difficulty: HARD | Source: https://codeforces.com/problemset/problem/784/F\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\na = 123 ** 511211\nprint(*sorted(list(map(int, input().split()))[1:]))\n```"}]}, {"id": "TACO-32", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nNote that the only difference between String Transformation 1 and String Transformation 2 is in the move Koa does. In this version the letter y Koa selects must be strictly greater alphabetically than x (read statement for better understanding). You can make hacks in these problems independently.\n\nKoa the Koala has two strings A and B of the same length n (|A|=|B|=n) consisting of the first 20 lowercase English alphabet letters (ie. from a to t).\n\nIn one move Koa:\n\n  1. selects some subset of positions p_1, p_2, …, p_k (k ≥ 1; 1 ≤ p_i ≤ n; p_i ≠ p_j if i ≠ j) of A such that A_{p_1} = A_{p_2} = … = A_{p_k} = x (ie. all letters on this positions are equal to some letter x).\n\n  2. selects a letter y (from the first 20 lowercase letters in English alphabet) such that y>x (ie. letter y is strictly greater alphabetically than x).\n\n  3. sets each letter in positions p_1, p_2, …, p_k to letter y. More formally: for each i (1 ≤ i ≤ k) Koa sets A_{p_i} = y.\n\nNote that you can only modify letters in string A.\n\n\n\n\nKoa wants to know the smallest number of moves she has to do to make strings equal to each other (A = B) or to determine that there is no way to make them equal. Help her!\n\nInput\n\nEach test contains multiple test cases. The first line contains t (1 ≤ t ≤ 10) — the number of test cases. Description of the test cases follows.\n\nThe first line of each test case contains one integer n (1 ≤ n ≤ 10^5) — the length of strings A and B.\n\nThe second line of each test case contains string A (|A|=n).\n\nThe third line of each test case contains string B (|B|=n).\n\nBoth strings consists of the first 20 lowercase English alphabet letters (ie. from a to t).\n\nIt is guaranteed that the sum of n over all test cases does not exceed 10^5.\n\nOutput\n\nFor each test case:\n\nPrint on a single line the smallest number of moves she has to do to make strings equal to each other (A = B) or -1 if there is no way to make them equal.\n\nExample\n\nInput\n\n\n5\n3\naab\nbcc\n4\ncabc\nabcb\n3\nabc\ntsr\n4\naabd\ncccd\n5\nabcbd\nbcdda\n\n\nOutput\n\n\n2\n-1\n3\n2\n-1\n\nNote\n\n  * In the 1-st test case Koa: \n    1. selects positions 1 and 2 and sets A_1 = A_2 =  b (\\color{red}{aa}b → \\color{blue}{bb}b). \n    2. selects positions 2 and 3 and sets A_2 = A_3 =  c (b\\color{red}{bb} → b\\color{blue}{cc}). \n\n  * In the 2-nd test case Koa has no way to make string A equal B.\n\n  * In the 3-rd test case Koa: \n    1. selects position 1 and sets A_1 =  t (\\color{red}{a}bc → \\color{blue}{t}bc). \n    2. selects position 2 and sets A_2 =  s (t\\color{red}{b}c → t\\color{blue}{s}c). \n    3. selects position 3 and sets A_3 =  r (ts\\color{red}{c} → ts\\color{blue}{r}).\n\nExample input:\n```\n10\n1\na\nb\n1\nb\na\n3\nabc\ndef\n1\nt\nt\n2\nrt\ntr\n2\nrt\ntt\n2\nrt\nrr\n3\nasd\nqrt\n1\ns\nt\n1\nr\nt\n```\n\nExpected output for the example input:\n```\n1\n-1\n3\n0\n-1\n1\n-1\n-1\n1\n1\n```\n\nMetadata: Difficulty: MEDIUM_HARD | Time limit: 1.0 seconds | Memory limit: 256.0 megabytes | Source: https://codeforces.com/problemset/problem/1384/C\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\ndef dfs(u):\n\tV[u] = 0\n\treturn sum((dfs(v) for v in g[u] if V[v])) + 1\nI = input\nfor _ in [0] * int(I()):\n\tI()\n\tV = [1] * 117\n\tg = [[] for _ in V]\n\tf = 0\n\tfor (x, y) in zip(map(ord, I()), map(ord, I())):\n\t\tf |= x > y\n\t\tg[x] += (y,)\n\t\tg[y] += (x,)\n\tprint((sum((dfs(i) - 1 for i in range(117) if V[i])), -1)[f])\n```"}]}, {"id": "TACO-33", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nMonocarp had a sequence $a$ consisting of $n + m$ integers $a_1, a_2, \\dots, a_{n + m}$. He painted the elements into two colors, red and blue; $n$ elements were painted red, all other $m$ elements were painted blue.\n\nAfter painting the elements, he has written two sequences $r_1, r_2, \\dots, r_n$ and $b_1, b_2, \\dots, b_m$. The sequence $r$ consisted of all red elements of $a$ in the order they appeared in $a$; similarly, the sequence $b$ consisted of all blue elements of $a$ in the order they appeared in $a$ as well.\n\nUnfortunately, the original sequence was lost, and Monocarp only has the sequences $r$ and $b$. He wants to restore the original sequence. In case there are multiple ways to restore it, he wants to choose a way to restore that maximizes the value of\n\n$$f(a) = \\max(0, a_1, (a_1 + a_2), (a_1 + a_2 + a_3), \\dots, (a_1 + a_2 + a_3 + \\dots + a_{n + m}))$$\n\nHelp Monocarp to calculate the maximum possible value of $f(a)$.\n\n\n-----Input-----\n\nThe first line contains one integer $t$ ($1 \\le t \\le 1000$) — the number of test cases. Then the test cases follow. Each test case consists of four lines.\n\nThe first line of each test case contains one integer $n$ ($1 \\le n \\le 100$).\n\nThe second line contains $n$ integers $r_1, r_2, \\dots, r_n$ ($-100 \\le r_i \\le 100$).\n\nThe third line contains one integer $m$ ($1 \\le m \\le 100$).\n\nThe fourth line contains $m$ integers $b_1, b_2, \\dots, b_m$ ($-100 \\le b_i \\le 100$).\n\n\n-----Output-----\n\nFor each test case, print one integer — the maximum possible value of $f(a)$.\n\n\n-----Examples-----\n\nInput\n4\n4\n6 -5 7 -3\n3\n2 3 -4\n2\n1 1\n4\n10 -3 2 2\n5\n-1 -2 -3 -4 -5\n5\n-1 -2 -3 -4 -5\n1\n0\n1\n0\nOutput\n13\n13\n0\n0\n\n\n-----Note-----\n\nIn the explanations for the sample test cases, red elements are marked as bold.\n\nIn the first test case, one of the possible sequences $a$ is $[\\mathbf{6}, 2, \\mathbf{-5}, 3, \\mathbf{7}, \\mathbf{-3}, -4]$.\n\nIn the second test case, one of the possible sequences $a$ is $[10, \\mathbf{1}, -3, \\mathbf{1}, 2, 2]$.\n\nIn the third test case, one of the possible sequences $a$ is $[\\mathbf{-1}, -1, -2, -3, \\mathbf{-2}, -4, -5, \\mathbf{-3}, \\mathbf{-4}, \\mathbf{-5}]$.\n\nIn the fourth test case, one of the possible sequences $a$ is $[0, \\mathbf{0}]$.\n\nExample input:\n```\n4\n4\n6 -5 7 -3\n3\n2 3 -4\n2\n1 1\n4\n10 -3 2 2\n5\n-1 -2 -3 -4 -5\n5\n-1 -2 -3 -4 -5\n1\n0\n1\n0\n```\n\nExpected output for the example input:\n```\n13\n13\n0\n0\n```\n\nMetadata: Difficulty: EASY | Time limit: 2 seconds | Memory limit: 512 megabytes | Source: https://codeforces.com/problemset/problem/1469/B\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nfrom itertools import *\nf = lambda : max(0, *accumulate(map(int, input().split())))\nexec(f() * 'f();r=f();f();print(r+f());')\n```"}]}, {"id": "TACO-34", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nRead problems statements in Mandarin Chinese, Russian and Vietnamese as well. \n\nSereja asks you to find out number of arrays A of size N, i.e. A_{1}, A_{2}, ..., A_{N} (1 ≤ A_{i} ≤ M), such that for each pair i, j (1 ≤ i < j ≤ N) gcd(A_{i}, A_{j}) = 1. \n\nAs the answer could be large, print it modulo 10^{9} + 7 (1000000007).\n\n------ Input ------ \n\nFirst line of the input contain an integer T - number of test cases. \n\nT tests follow. First line of each test case contain two space separated integers N, M. \n\n------ Output ------ \n\nFor each test case output required answer modulo 10^{9} + 7.\n\n------ Constraints ------ \n\n$1 ≤ T ≤  10 $\n$1 ≤ N ≤  10^{5} $\n$1 ≤ M ≤  100 $\n\n------ Subtasks ------ \n\n$Subtask #1: (10 points, TL = 5 secs) 1 ≤ N, M ≤  10 $\n$Subtask #2: (25 points, TL = 5 secs) 1 ≤ N ≤  100 $\n$Subtask #3: (65 points, TL = 5 secs) original$\n\n------ Example ------ \n\nInput:\n2\n1 1\n3 3\n\nOutput:\n1\n13\n\nExample input:\n```\n2\n1 1\n3 3\n```\n\nExpected output for the example input:\n```\n1\n13\n```\n\nMetadata: Difficulty: VERY_HARD | Time limit: 5 seconds | Memory limit: 50000 bytes | Source: https://www.codechef.com/problems/SEAGCD2\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\ndef egcd(a, b):\n\tif a == 0:\n\t\treturn (b, 0, 1)\n\telse:\n\t\t(g, y, x) = egcd(b % a, a)\n\t\treturn (g, x - b // a * y, y)\n\ndef modinv(a, m):\n\twhile a < 0:\n\t\ta += m\n\t(g, x, y) = egcd(a, m)\n\tif g != 1:\n\t\traise Exception('Modular inverse does not exist')\n\telse:\n\t\treturn x % m\nmod = 10 ** 9 + 7\nmaxM = 100\np = [False, False] + [True for _ in range(maxM - 1)]\nfact = [[] for _ in range(maxM + 1)]\nfor i in range(2, maxM + 1):\n\tif p[i]:\n\t\tfor j in range(1, maxM // i + 1):\n\t\t\tif j > 1:\n\t\t\t\tp[i * j] = False\n\t\t\tfact[i * j].append(i)\ninv_fact = {}\nfor i in range(maxM + 1):\n\tfor f in fact[i]:\n\t\tif not f in inv_fact:\n\t\t\tinv_fact[f] = set()\n\t\tinv_fact[f].add(i)\nF = [1]\nfor i in range(1, 10 ** 5 + 1):\n\tF.append(F[-1] * i % mod)\nmod_inv_F = list(map(lambda x: modinv(x, mod), F))\n\ndef g(n, k):\n\treturn F[n] * mod_inv_F[n - k] % mod\n\ndef h(nums):\n\thsh = []\n\talias = {}\n\ti = 0\n\tfor n in nums:\n\t\tfor f in fact[n]:\n\t\t\tif not f in alias:\n\t\t\t\talias[f] = i\n\t\t\t\ti += 1\n\t\thsh.append(tuple(map(lambda x: alias[x], fact[n])))\n\treturn tuple(sorted(hsh))\ncache = {}\n\ndef get_lens(n, available, l):\n\tres = g(n, l)\n\tif n == l or len(available) == 0:\n\t\treturn res\n\thsh = (n, l, h(available))\n\tif hsh in cache:\n\t\treturn cache[hsh]\n\tfor a in available:\n\t\tacopy = set(available)\n\t\tfor f in fact[a]:\n\t\t\tacopy -= inv_fact[f]\n\t\tfor el in available:\n\t\t\tif el >= a and el in acopy:\n\t\t\t\tacopy.remove(el)\n\t\tres += get_lens(n, acopy, l + 1)\n\t\tres %= mod\n\tcache[hsh] = res\n\treturn res\nfor _ in range(int(input())):\n\t(n, m) = map(int, input().split())\n\tprint(get_lens(n, set(range(2, m + 1)), 0))\n```"}]}, {"id": "TACO-35", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nRead problems statements in [Mandarin Chinese], [Russian], [Vietnamese] and [Bengali] as well.\n\nYou have taken an eating challenge from Chef and now you have to eat exactly $Y$ burgers. You will eat in the following way:\n\nIn the first minute you will eat exactly $X$ burgers and every minute after that you will eat exactly twice the number of burgers you ate in the previous minute. \nSince you can get tired of eating, Chef also allows you take a break from eating for exactly $1$ minute.\nWhen you start eating again after taking a break, your eating streak resets, i.e. in the first minute after the break you will eat exactly $X$ burgers and every minute after that you will eat exactly double the burgers you ate on the previous minute. \n\nLet $a_{1}, a_{2}, ..., a_{k}$ be the lengths of your eating streaks in minutes. Chef requires that all $a_{i}$ are pairwise distinct.\n\nFind the minimum number of minutes you need to eat exactly $Y$ burgers or determine it is impossible to do so.\n\n------ Input ------\n\nThe first line contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\nThe first and only line of each test case contains two space-separated integers $X$ and $Y$.\n\n------ Output ------\nFor each test case, print a single line containing one integer — the minimum number of minutes you need to eat exactly $Y$ burgers, or $−1$ if it is impossible.\n\n------ Constraints  ------\n$1≤ T≤ 10^{5}$\n$1≤ X,Y≤ 10^{18}$\n\n----- Sample Input 1 ------ \n2\n\n1 7\n\n1 4\n----- Sample Output 1 ------ \n3\n\n4\n\nExample input:\n```\n2\n1 7\n1 4\n```\n\nExpected output for the example input:\n```\n3\n4\n```\n\nMetadata: Difficulty: HARD | Time limit: 1 seconds | Memory limit: 50000 bytes | Source: https://www.codechef.com/problems/BURGER\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nt = int(input())\nfor _ in range(t):\n\t(x, y) = map(int, input().split())\n\tans = 0\n\tif y % x != 0:\n\t\tprint(-1)\n\telse:\n\t\ty //= x\n\t\tfor i in range(61, 0, -1):\n\t\t\tif y >= (1 << i) - 1:\n\t\t\t\tans += i + 1\n\t\t\t\ty -= (1 << i) - 1\n\t\tprint([-1, ans - 1][y == 0])\n```"}]}, {"id": "TACO-36", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nYou are given n points on the straight line — the positions (x-coordinates) of the cities and m points on the same line — the positions (x-coordinates) of the cellular towers. All towers work in the same way — they provide cellular network for all cities, which are located at the distance which is no more than r from this tower.\n\nYour task is to find minimal r that each city has been provided by cellular network, i.e. for each city there is at least one cellular tower at the distance which is no more than r.\n\nIf r = 0 then a tower provides cellular network only for the point where it is located. One tower can provide cellular network for any number of cities, but all these cities must be at the distance which is no more than r from this tower.\n\n\n-----Input-----\n\nThe first line contains two positive integers n and m (1 ≤ n, m ≤ 10^5) — the number of cities and the number of cellular towers.\n\nThe second line contains a sequence of n integers a_1, a_2, ..., a_{n} ( - 10^9 ≤ a_{i} ≤ 10^9) — the coordinates of cities. It is allowed that there are any number of cities in the same point. All coordinates a_{i} are given in non-decreasing order.\n\nThe third line contains a sequence of m integers b_1, b_2, ..., b_{m} ( - 10^9 ≤ b_{j} ≤ 10^9) — the coordinates of cellular towers. It is allowed that there are any number of towers in the same point. All coordinates b_{j} are given in non-decreasing order.\n\n\n-----Output-----\n\nPrint minimal r so that each city will be covered by cellular network.\n\n\n-----Examples-----\nInput\n3 2\n-2 2 4\n-3 0\n\nOutput\n4\n\nInput\n5 3\n1 5 10 14 17\n4 11 15\n\nOutput\n3\n\nExample input:\n```\n3 2\n-2 2 4\n-3 0\n```\n\nExpected output for the example input:\n```\n4\n```\n\nMetadata: Difficulty: MEDIUM | Source: https://codeforces.com/problemset/problem/702/C\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nfrom bisect import bisect as b\n[_, k, t] = [list(map(int, input().split())) for i in [0] * 3]\nprint(max([min([abs(x - c) for x in t[max(0, b(t, c) - 1):b(t, c) + 2]] + [9 ** 99]) for c in k]))\n```"}]}, {"id": "TACO-37", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nMisha hacked the Codeforces site. Then he decided to let all the users change their handles. A user can now change his handle any number of times. But each new handle must not be equal to any handle that is already used or that was used at some point.\n\nMisha has a list of handle change requests. After completing the requests he wants to understand the relation between the original and the new handles of the users. Help him to do that.\n\n\n-----Input-----\n\nThe first line contains integer q (1 ≤ q ≤ 1000), the number of handle change requests.\n\nNext q lines contain the descriptions of the requests, one per line.\n\nEach query consists of two non-empty strings old and new, separated by a space. The strings consist of lowercase and uppercase Latin letters and digits. Strings old and new are distinct. The lengths of the strings do not exceed 20.\n\nThe requests are given chronologically. In other words, by the moment of a query there is a single person with handle old, and handle new is not used and has not been used by anyone.\n\n\n-----Output-----\n\nIn the first line output the integer n — the number of users that changed their handles at least once.\n\nIn the next n lines print the mapping between the old and the new handles of the users. Each of them must contain two strings, old and new, separated by a space, meaning that before the user had handle old, and after all the requests are completed, his handle is new. You may output lines in any order.\n\nEach user who changes the handle must occur exactly once in this description.\n\n\n-----Examples-----\nInput\n5\nMisha ILoveCodeforces\nVasya Petrov\nPetrov VasyaPetrov123\nILoveCodeforces MikeMirzayanov\nPetya Ivanov\n\nOutput\n3\nPetya Ivanov\nMisha MikeMirzayanov\nVasya VasyaPetrov123\n\nExample input:\n```\n5\nMisha ILoveCodeforces\nVasya Petrov\nPetrov VasyaPetrov123\nILoveCodeforces MikeMirzayanov\nPetya Ivanov\n```\n\nExpected output for the example input:\n```\n3\nPetya Ivanov\nMisha MikeMirzayanov\nVasya VasyaPetrov123\n```\n\nMetadata: Difficulty: EASY | Source: https://codeforces.com/problemset/problem/501/B\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nh = {}\nq = int(input())\nfor _ in range(q):\n\t(o, n) = input().split()\n\to = h.pop(o, o)\n\th.setdefault(n, o)\nprint(len(h))\nfor (n, o) in h.items():\n\tprint(o, n)\n```"}]}, {"id": "TACO-38", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nWatson gives a square of side length 1 to Sherlock. Now, after each second, each square of some arbitrary side $\\boldsymbol{\\mbox{I}}$ will break into four squares each of side $L/2$(as shown in the image below). \n\nNow, Watson asks Sherlock: What will be the sum of length of solid lines after $N$ seconds?  \n\nAs the number can be large print result mod $(10^9+7)$.\n\nFor example, after 0 seconds, the length is 4. \n\nAfter 1 second, the length is 6.\n\nInput Format \n\nFirst line contains $\\mathbf{T}$, the number of testcases. Each testcase contains $N$ in one line.   \n\nOutput Format\n\nFor each testcase, print the required answer in a new line. \n\nConstraints \n\n$1\\leq T\\leq10^5$ \n\n$0\\leq N\\leq10^9$\n\nSample input\n\n3\n0\n1\n5\n\nSample output\n\n4\n6\n66\n\nExample input:\n```\n3\n0\n1\n5\n```\n\nExpected output for the example input:\n```\n4\n6\n66\n```\n\nMetadata: Difficulty: MEDIUM_HARD | Source: https://www.hackerrank.com/challenges/sherlock-and-square/problem\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nfor _ in range(int(input())):\n\tprint(2 + pow(2, int(input()) + 1, 1000000007))\n```"}]}, {"id": "TACO-39", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nThere is a programming language in which every program is a non-empty sequence of \"<\" and \">\" signs and digits. Let's explain how the interpreter of this programming language works. A program is interpreted using movement of instruction pointer (IP) which consists of two parts.\n\n  * Current character pointer (CP); \n  * Direction pointer (DP) which can point left or right; \n\n\n\nInitially CP points to the leftmost character of the sequence and DP points to the right.\n\nWe repeat the following steps until the first moment that CP points to somewhere outside the sequence.\n\n  * If CP is pointing to a digit the interpreter prints that digit then CP moves one step according to the direction of DP. After that the value of the printed digit in the sequence decreases by one. If the printed digit was 0 then it cannot be decreased therefore it's erased from the sequence and the length of the sequence decreases by one. \n  * If CP is pointing to \"<\" or \">\" then the direction of DP changes to \"left\" or \"right\" correspondingly. Then CP moves one step according to DP. If the new character that CP is pointing to is \"<\" or \">\" then the previous character will be erased from the sequence. \n\n\n\nIf at any moment the CP goes outside of the sequence the execution is terminated.\n\nIt's obvious the every program in this language terminates after some steps.\n\nWe have a sequence s1, s2, ..., sn of \"<\", \">\" and digits. You should answer q queries. Each query gives you l and r and asks how many of each digit will be printed if we run the sequence sl, sl + 1, ..., sr as an independent program in this language.\n\nInput\n\nThe first line of input contains two integers n and q (1 ≤ n, q ≤ 105) — represents the length of the sequence s and the number of queries. \n\nThe second line contains s, a sequence of \"<\", \">\" and digits (0..9) written from left to right. Note, that the characters of s are not separated with spaces. \n\nThe next q lines each contains two integers li and ri (1 ≤ li ≤ ri ≤ n) — the i-th query.\n\nOutput\n\nFor each query print 10 space separated integers: x0, x1, ..., x9 where xi equals the number of times the interpreter prints i while running the corresponding program. Print answers to the queries in the order they are given in input.\n\nExamples\n\nInput\n\n7 4\n1&gt;3&gt;22&lt;\n1 3\n4 7\n7 7\n1 7\n\n\nOutput\n\n0 1 0 1 0 0 0 0 0 0\n2 2 2 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0\n2 3 2 1 0 0 0 0 0 0\n\nExample input:\n```\n5 1\n1>3><\n4 5\n```\n\nExpected output for the example input:\n```\n0 0 0 0 0 0 0 0 0 0\n```\n\nMetadata: Difficulty: VERY_HARD | Time limit: 2.0 seconds | Memory limit: 256.0 megabytes | Source: https://codeforces.com/problemset/problem/238/D\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\n(n, q) = map(int, input().split())\ns = input()\nfor _ in range(q):\n\t(l, r) = map(int, input().split())\n\tt = list(s[l - 1:r])\n\t(p, d) = (0, 1)\n\tres = [0] * 10\n\twhile 0 <= p < len(t):\n\t\tif '0' <= t[p] <= '9':\n\t\t\tk = int(t[p])\n\t\t\tres[k] += 1\n\t\t\tif k > 0:\n\t\t\t\tt[p] = str(k - 1)\n\t\t\t\tp += d\n\t\t\telse:\n\t\t\t\tt.pop(p)\n\t\t\t\tif d == -1:\n\t\t\t\t\tp += d\n\t\telse:\n\t\t\td = -1 if t[p] == '<' else 1\n\t\t\tif 0 <= p + d < len(t) and (not '0' <= t[p + d] <= '9'):\n\t\t\t\tt.pop(p)\n\t\t\t\tif d == -1:\n\t\t\t\t\tp += d\n\t\t\telse:\n\t\t\t\tp += d\n\tprint(*res)\n```"}]}, {"id": "TACO-40", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nGiven a positive integer N, find a possible arrangement of the integers from 0 to N -1 such that the binary representation of every number (except the first) differs at most at one bit from the binary representation of the number before it. Or tell that it’s impossible to get such an arrangement.\n\n------ Input ------ \n\nThe first line of the input contains a single integer T denoting the number of test cases. The description of T test cases follows.\nThe first and only line of each test case contains a single integer N.\n\n------ Output ------ \n\nFor every testcase print N integers on a single line, the required sequence. If there are multiple possible answers, print any one.\nIf no such sequence is possible, print -1.\n\n------ Constraints ------ \n\n$1 ≤ T ≤ 2000$\n$1 ≤ N ≤ 100000$\n$1 ≤ sum of N over all test cases ≤ 2000000$\n\n------ Example ------ \n\nInput:\n5\n1\n2\n3\n4\n5\n\nOutput:\n0 \n0 1 \n2 0 1 \n0 1 3 2 \n4 0 1 3 2 \n\n------ Explanation ------ \n\nBinary representation of the numbers in the output for N=5 are :\n100, 000, 001, 011, and 010.\n\nExample input:\n```\n5\n1\n2\n3\n4\n5\n```\n\nExpected output for the example input:\n```\n0 \n0 1 \n2 0 1 \n0 1 3 2 \n4 0 1 3 2\n```\n\nMetadata: Difficulty: VERY_HARD | Time limit: 1 seconds | Memory limit: 50000 bytes | Source: https://www.codechef.com/problems/ENIG10\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\ndef sol(arr, ct, x):\n\twhile ct <= n - 2:\n\t\tfor i in range(len(arr)):\n\t\t\tif arr[i] == 0:\n\t\t\t\tnumbr = x + 2 ** i\n\t\t\t\tif numbr < n and status[numbr] == 0:\n\t\t\t\t\tarr[i] = 1\n\t\t\t\t\tstatus[numbr] = 1\n\t\t\t\t\tct += 1\n\t\t\t\t\tprint(numbr, end=' ')\n\t\t\t\t\tx = numbr\n\t\t\t\t\tbreak\n\t\t\telse:\n\t\t\t\tnumbr = x - 2 ** i\n\t\t\t\tif numbr < n and status[numbr] == 0:\n\t\t\t\t\tprint(numbr, end=' ')\n\t\t\t\t\tarr[i] = 0\n\t\t\t\t\tstatus[numbr] = 1\n\t\t\t\t\tct += 1\n\t\t\t\t\tx = numbr\n\t\t\t\t\tbreak\nt = int(input())\nfor j in range(t):\n\tn = int(input())\n\tarr = [0] * 32\n\tx = n - 1\n\tk = 0\n\tstatus = [0] * 100001\n\twhile x > 0:\n\t\tarr[k] = x & 1\n\t\tx //= 2\n\t\tk += 1\n\tstatus[n - 1] = 1\n\tprint(n - 1, end=' ')\n\tsol(arr, 0, n - 1)\n\tprint()\n```"}]}, {"id": "TACO-41", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\n*\"Raju - zor zor se bolke sabko scheme bata de\".  \nRaju intends to scam everyone in order to become rich quickly. But before doing that, he must prove to everyone his innocence, by doubling his own money with the help of a scheme.*\n\nRaju wants to double his money, but in order to invest in the scheme, he is required to solve the following problem. He has asked you to help him in solving the problem.\n\nYou are given the following:\nK strings P_{1}, P_{2}, P_{3}, \\ldots, P_{K}\nA string S of length N.\nSome number of available characters from 'a' to 'z'. This is given to you as an array C of size 26, where C_{1} is the number of 'a'-s, C_{2} is the number of 'b'-s, \\ldots, C_{26} is the number of 'z'-s you have.\n\nSolve the following problem independently for each X from 0 to K:\nIs it possible to append some (possibly 0) characters to S from the available characters such that the resulting string is strictly lexicographically greater than *exactly* X of the given K strings?\n\nNote that the process is independent for each X. That is, for each X, you start with the original string S and the values C_{1}, C_{2}, \\ldots, C_{26} given in the input.\n\nNote: A string A is said to be lexicographically larger than a string B if:\nB is a proper prefix of A (for example, abc is larger than a and ab); or\nLet i be the first position where A and B differ (i.e, A_{1} = B_{1}, A_{2} = B_{2}, \\ldots, A_{i-1} = B_{i-1}). Then, A_{i} > B_{i}.\n\n------ Input Format ------ \n\n- The first line of input will contain one integer N, the size of the string S.\n- The second line of input will contain string S.\n- The third line of input will contain 26 space-separated integers, representing the values C_{1}, C_{2}, \\ldots, C_{26}.\n- The fourth line of input will contain one integer K.\n- The i-th of the next K lines of input will contain the string P_{i}.\n\n------ Output Format ------ \n\nPrint K+1 lines of output. The i-th of these lines should contain the answer for X = i-1: Yes if it's possible to append some of the given characters to S to make it strictly lexicographically larger than exactly i-1 strings, and No otherwise.\n\nEach letter of the output may be printed in either uppercase or lowercase, i.e, Yes, YES, and yEs will all be treated as equivalent.\n\n------ Constraints ------ \n\n$1 ≤ N ≤ 10^{4}$\n$0 ≤ C_{i} ≤ 10^{6}$\n$1 ≤ K ≤ 10^{4}$\n$1 ≤ |P_{i}| ≤ 10^{4}$\n- Every input string will contain only lowercase English letters, i.e, the letters from $a$ to $z$.\n- The sum of $|P_{i}|$ across all $K$ strings won't exceed $10^{5}$.\n\n----- Sample Input 1 ------ \n4\nabcd\n1 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1\n6\nabc\nabcd\nab\nabcde\na\nabcd\n\n----- Sample Output 1 ------ \nNo\nNo\nNo\nYes\nNo\nYes\nYes\n\n----- explanation 1 ------ \nThe answer for a few values of $X$ is as follows:\n\n- $X = 3$: Leave $S$ unchanged, and it is already greater than exactly three of the given strings (\"abc\", \"ab\", \"a\"). So, the answer is \"Yes\".\n- $X = 4$: There is no way to append some characters to the string $S$ from the ones we have (one copy each of 'a', 'c', 'z') such that the resulting string will be greater than exactly $4$ strings out of the given $6$ strings. So, the output is \"No\".\n- $X = 5$: Append 'c' to $S$, to form \"abcdc\". This is greater than all the input strings except \"abcde\", as needed.\n- $X = 6$: Append 'z' to $S$, to form \"abcdz\". This is greater than every input string.\n\nExample input:\n```\n4\nabcd\n1 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1\n6\nabc\nabcd\nab\nabcde\na\nabcd\n```\n\nExpected output for the example input:\n```\nNo\nNo\nNo\nYes\nNo\nYes\nYes\n```\n\nMetadata: Difficulty: VERY_HARD | Time limit: 1 seconds | Memory limit: 50000 bytes | Source: https://www.codechef.com/problems/RJSTRING\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nn = int(input())\ns = input()\nhave = list(map(int, input().split()))\nk = int(input())\nstrings = sorted(list((input() for _ in range(k))))\nstrings.append((len(strings[-1]) + 5) * 'z')\nprint('Yes' if s <= strings[0] else 'No')\nfor i in range(k):\n\tif strings[i] == strings[i + 1] or s > strings[i + 1]:\n\t\tprint('No')\n\t\tcontinue\n\tif s > strings[i]:\n\t\tprint('Yes')\n\t\tcontinue\n\tif len(strings[i]) < n or strings[i][:n] != s:\n\t\tprint('No')\n\t\tcontinue\n\tused = [0 for _ in range(26)]\n\tans = 'Yes'\n\tispref = strings[i + 1][:n] == s\n\tfor pos in range(n, 200000):\n\t\thi = 0\n\t\tif ispref == True:\n\t\t\thi = ord(strings[i + 1][pos]) - ord('a') + 1\n\t\telse:\n\t\t\thi = 26\n\t\tif pos == len(strings[i]):\n\t\t\tans = 'No'\n\t\t\tfor c in range(hi):\n\t\t\t\tif used[c] < have[c]:\n\t\t\t\t\tans = 'Yes'\n\t\t\t\t\tbreak\n\t\t\tbreak\n\t\tlo = ord(strings[i][pos]) - ord('a') + 1\n\t\tans = 'No'\n\t\tfor c in range(lo, hi):\n\t\t\tif used[c] < have[c]:\n\t\t\t\tans = 'Yes'\n\t\t\t\tbreak\n\t\tif ans == 'Yes':\n\t\t\tbreak\n\t\tif used[lo - 1] < have[lo - 1]:\n\t\t\tused[lo - 1] += 1\n\t\t\tif ispref == True and strings[i][pos] != strings[i + 1][pos]:\n\t\t\t\tispref = False\n\t\t\tans = 'Yes'\n\t\t\tcontinue\n\t\tans = 'No'\n\t\tbreak\n\tprint(ans)\n```"}]}, {"id": "TACO-42", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nA never-ending, fast-changing and dream-like world unfolds, as the secret door opens.\n\nA world is an unordered graph G, in whose vertex set V(G) there are two special vertices s(G) and t(G). An initial world has vertex set {s(G), t(G)} and an edge between them.\n\nA total of n changes took place in an initial world. In each change, a new vertex w is added into V(G), an existing edge (u, v) is chosen, and two edges (u, w) and (v, w) are added into E(G). Note that it's possible that some edges are chosen in more than one change.\n\nIt's known that the capacity of the minimum s-t cut of the resulting graph is m, that is, at least m edges need to be removed in order to make s(G) and t(G) disconnected.\n\nCount the number of non-similar worlds that can be built under the constraints, modulo 10^9 + 7. We define two worlds similar, if they are isomorphic and there is isomorphism in which the s and t vertices are not relabelled. Formally, two worlds G and H are considered similar, if there is a bijection between their vertex sets $f : V(G) \\rightarrow V(H)$, such that:   f(s(G)) = s(H);  f(t(G)) = t(H);  Two vertices u and v of G are adjacent in G if and only if f(u) and f(v) are adjacent in H. \n\n\n-----Input-----\n\nThe first and only line of input contains two space-separated integers n, m (1 ≤ n, m ≤ 50) — the number of operations performed and the minimum cut, respectively.\n\n\n-----Output-----\n\nOutput one integer — the number of non-similar worlds that can be built, modulo 10^9 + 7.\n\n\n-----Examples-----\nInput\n3 2\n\nOutput\n6\n\nInput\n4 4\n\nOutput\n3\n\nInput\n7 3\n\nOutput\n1196\n\nInput\n31 8\n\nOutput\n64921457\n\n\n\n-----Note-----\n\nIn the first example, the following 6 worlds are pairwise non-similar and satisfy the constraints, with s(G) marked in green, t(G) marked in blue, and one of their minimum cuts in light blue.\n\n [Image] \n\nIn the second example, the following 3 worlds satisfy the constraints.\n\n [Image]\n\nExample input:\n```\n3 2\n```\n\nExpected output for the example input:\n```\n6\n```\n\nMetadata: Difficulty: VERY_HARD | Source: https://codeforces.com/problemset/problem/848/D\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nmod = int(1000000000.0 + 7)\n(n, m) = map(int, input().split())\nf = [[0 for i in range(60)] for j in range(60)]\ng = [[0 for i in range(60)] for j in range(60)]\ns = [[0 for i in range(60)] for j in range(60)]\ninv = [1]\nf[0][0] = s[0][0] = 1\n\ndef pow(x, exp):\n\tres = 1\n\tfor i in range(0, 31):\n\t\tif exp & 1:\n\t\t\tres = res * x % mod\n\t\texp >>= 1\n\t\tif exp == 0:\n\t\t\tbreak\n\t\tx = x * x % mod\n\treturn res\nfor i in range(1, n + 1):\n\tinv.append(pow(i, mod - 2))\nfor node in range(1, n + 1):\n\tfor cut in range(1, n + 1):\n\t\ttmp = 0\n\t\tfor ln in range(node):\n\t\t\tfor lc in range(cut - 1, n + 1):\n\t\t\t\tif f[ln][lc] == 0:\n\t\t\t\t\tcontinue\n\t\t\t\tif lc == cut - 1:\n\t\t\t\t\ttmp = (tmp + f[ln][lc] * s[node - ln - 1][cut - 1]) % mod\n\t\t\t\telse:\n\t\t\t\t\ttmp = (tmp + f[ln][lc] * f[node - ln - 1][cut - 1]) % mod\n\t\tcnt = 1\n\t\tif tmp != 0:\n\t\t\t(cn, cc) = (0, 0)\n\t\t\tfor i in range(1, n + 1):\n\t\t\t\tcn += node\n\t\t\t\tcc += cut\n\t\t\t\tcnt = cnt * (tmp + i - 1) % mod * inv[i] % mod\n\t\t\t\tif cn > n or cc > n:\n\t\t\t\t\tbreak\n\t\t\t\tfor j in range(n - cn, -1, -1):\n\t\t\t\t\tfor k in range(n - cc, -1, -1):\n\t\t\t\t\t\tif f[j][k] == 0:\n\t\t\t\t\t\t\tcontinue\n\t\t\t\t\t\tg[j + cn][k + cc] += f[j][k] * cnt\n\t\t\t\t\t\tg[j + cn][k + cc] %= mod\n\t\t\tfor i in range(n + 1):\n\t\t\t\tfor j in range(n + 1):\n\t\t\t\t\tf[i][j] = (f[i][j] + g[i][j]) % mod\n\t\t\t\t\tg[i][j] = 0\n\tfor cut in range(n, -1, -1):\n\t\ts[node][cut] = (s[node][cut + 1] + f[node][cut]) % mod\nprint(f[n][m - 1])\n```"}]}, {"id": "TACO-43", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nGiven N separate integer points on the Cartesian plane satisfying: there is no any three of them sharing a same X-coordinate. Your task is to count the number of rectangles (whose edges parrallel to the axes) created from any four of given points.\n\n------ Input ------ \n\nThere are several test cases (ten at most), each formed as follows:\nThe first line contains a positive integer N (N ≤ 10^{5}).\nN lines follow, each containing a pair of integers (each having an absolute value of 10^{9} at most) describing coordinates of a given point.\n\nThe input is ended with N = 0.\n\n------ Output ------ \n\nFor each test case, output on a line an integer which is the respective number of rectangles found.\n\n----- Sample Input 1 ------ \n6\n7 1\n3 5\n3 1\n1 5\n1 1\n7 5\n0\n----- Sample Output 1 ------ \n3\n\nExample input:\n```\n6\n7 1\n3 5\n3 1\n1 5\n1 1\n7 5\n0\n```\n\nExpected output for the example input:\n```\n3\n```\n\nMetadata: Difficulty: MEDIUM_HARD | Time limit: 0.176 seconds | Memory limit: 50000 bytes | Source: https://www.codechef.com/problems/RECTCNT\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nimport collections\nn = int(input())\nwhile n != 0:\n\tpoints = []\n\tfor _ in range(n):\n\t\tpoints.append(tuple(map(int, input().split())))\n\tpoints.sort()\n\tans = 0\n\tsides = collections.defaultdict(int)\n\tfor i in range(n - 1):\n\t\t(x1, y1) = points[i]\n\t\t(x2, y2) = points[i + 1]\n\t\tif x1 == x2:\n\t\t\tans += sides[y1, y2]\n\t\t\tsides[y1, y2] += 1\n\tprint(ans)\n\tn = int(input())\n```"}]}, {"id": "TACO-44", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nRead problems statements in Mandarin chinese, Russian and Vietnamese as well. \n\nChef always likes to play with arrays. He came up with a new term \"magical subarray\". A subarray is called magical if its starting index is 1 (1-based indexing). Now, Chef has an array of N elements and 2 types of queries:\n\ntype 1: Given two numbers i and x, the value at index i should be updated to x.\ntype 2: Given two numbers i and k, your program should output the total number of magical subarrays with the last index ≤ i in which the xor of all elements is equal to k.\n\n------ Input ------ \n\nThe first line of the input contains two integers N and Q denoting the number of elements in the array and the number of queries respectively.\nThe second line contains N space-separated integers A_{1}, A_{2} ... A_{N} denoting the initial values of the array.\nEach of the following Q lines describes an operation. If the first integer is 1, it means that the operation is of type 1 and it will be followed by two integers i and x. If the first integer is 2, it means that the operations is of type 2 and it will be followed by two integers i and k.\n\n------ Output ------ \n\nFor each operation of type 2, print the number of magical subarrays on a separate line.\n\n------ Constraints ------ \n\n$1 ≤ N, Q ≤ 100,000$\n$1 ≤ A[i] ≤ 1,000,000$\n$1 ≤ i ≤ N$\n$1 ≤ x, k ≤ 1,000,000$\n\n------ Subtasks ------ \n\nSubtask #1 (20 points): 1 ≤ N, Q ≤ 1,000\n\nSubtask #2 (30 points): 1 ≤ N, Q ≤ 10,000\n\nSubtask #3 (50 points): original constraints\n\n----- Sample Input 1 ------ \n5 3\n1 1 1 1 1\n2 5 1\n1 3 2\n2 5 1\n----- Sample Output 1 ------ \n3\n1\n\nExample input:\n```\n5 3\n1 1 1 1 1\n2 5 1\n1 3 2\n2 5 1\n```\n\nExpected output for the example input:\n```\n3\n1\n```\n\nMetadata: Difficulty: HARD | Time limit: 3 seconds | Memory limit: 50000 bytes | Source: https://www.codechef.com/problems/CHEFEXQ\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nimport numpy\n(n, q) = map(int, input().split())\na = list(map(int, input().split()))\narr = [a[0]]\nfor i in range(1, n):\n\tarr.append(arr[-1] ^ a[i])\narr = numpy.array(arr)\nfor _ in range(q):\n\t(t, i, k) = map(int, input().split())\n\tif t == 1:\n\t\tb = a[i - 1] ^ k\n\t\ta[i - 1] = k\n\t\tarr[i - 1:] ^= b\n\telse:\n\t\tprint(numpy.count_nonzero(arr[:i] == k))\n```"}]}, {"id": "TACO-45", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nQpwoeirut has taken up architecture and ambitiously decided to remodel his city.\n\nQpwoeirut's city can be described as a row of $n$ buildings, the $i$-th ($1 \\le i \\le n$) of which is $h_i$ floors high. You can assume that the height of every floor in this problem is equal. Therefore, building $i$ is taller than the building $j$ if and only if the number of floors $h_i$ in building $i$ is larger than the number of floors $h_j$ in building $j$.\n\nBuilding $i$ is cool if it is taller than both building $i-1$ and building $i+1$ (and both of them exist). Note that neither the $1$-st nor the $n$-th building can be cool.\n\nTo remodel the city, Qpwoeirut needs to maximize the number of cool buildings. To do this, Qpwoeirut can build additional floors on top of any of the buildings to make them taller. Note that he cannot remove already existing floors.\n\nSince building new floors is expensive, Qpwoeirut wants to minimize the number of floors he builds. Find the minimum number of floors Qpwoeirut needs to build in order to maximize the number of cool buildings.\n\n\n-----Input-----\n\nThe first line contains a single integer $t$ ($1 \\le t \\le 10^4$) — the number of test cases.\n\nThe first line of each test case contains the single integer $n$ ($3 \\le n \\le 10^5$) — the number of buildings in Qpwoeirut's city.\n\nThe second line of each test case contains $n$ integers $h_1, h_2, \\ldots, h_n$ ($1 \\le h_i \\le 10^9$) — the number of floors in each of the buildings of the city.\n\nIt is guaranteed that the sum of $n$ over all test cases does not exceed $2 \\cdot 10^5$.\n\n\n-----Output-----\n\nFor each test case, print a single integer — the minimum number of additional floors Qpwoeirut needs to build in order to maximize the number of cool buildings.\n\n\n-----Examples-----\n\nInput\n6\n3\n2 1 2\n5\n1 2 1 4 3\n6\n3 1 4 5 5 2\n8\n4 2 1 3 5 3 6 1\n6\n1 10 1 1 10 1\n8\n1 10 11 1 10 11 10 1\nOutput\n2\n0\n3\n3\n0\n4\n\n\n-----Note-----\n\nIn the first test case, it is optimal for Qpwoeirut to make the second building cool by building $2$ additional floors on top of it, making it taller than both of its adjacent buildings. The final heights of buildings will be $[2, \\underline{3}, 2]$.\n\nIn the second test case, the number of cool buildings is already maximized, so Qpwoeirut does not need to do anything.\n\nIn the third test case, it is optimal for Qpwoeirut to make the third and fifth buildings cool by building $2$ additional floors onto the third building and $1$ additional floor onto the fifth building. The final heights of buildings will be $[3, 1, \\underline{6}, 5, \\underline{6}, 2]$.\n\nIt can be shown that it is impossible to make more than $2$ of the buildings cool, or to make $2$ buildings cool using fewer than $3$ additional floors.\n\nIn the fourth test case, Qpwoeirut can either make the second building cool, or he can make the third building cool. Either way, he will be building $3$ additional floors and maximizing the number of cool buildings. The final heights of buildings will be $[4, 2, \\underline{4}, 3, 5, 3, 6, 1]$ or $[4, \\underline{5}, 1, 3, 5, 3, 6, 1]$.\n\nExample input:\n```\n6\n3\n2 1 2\n5\n1 2 1 4 3\n6\n3 1 4 5 5 2\n8\n4 2 1 3 5 3 6 1\n6\n1 10 1 1 10 1\n8\n1 10 11 1 10 11 10 1\n```\n\nExpected output for the example input:\n```\n2\n0\n3\n3\n0\n4\n```\n\nMetadata: Difficulty: MEDIUM | Time limit: 1 second | Memory limit: 256 megabytes | Source: https://codeforces.com/problemset/problem/1706/C\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nfor t in range(int(input())):\n\tn = int(input())\n\ts = [*map(int, input().split())]\n\tl = []\n\tfor i in range(1, n - 1):\n\t\tl.append(max(0, max(s[i - 1], s[i + 1]) + 1 - s[i]))\n\tif n % 2 == 1:\n\t\tprint(sum(l[::2]))\n\t\tcontinue\n\ta = sum(l[1::2])\n\tb = a\n\tfor i in range(0, len(l), 2):\n\t\tb += l[i] - l[i + 1]\n\t\ta = min(a, b)\n\tprint(a)\n```"}]}, {"id": "TACO-46", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nTherasa is a Nurse. She wants to give some tablets to the patients in her practice.  All the patients sit in a line and each of them  has a rating score according to his or her health score. Therasa wants to give at least 1 tablet for each patient. Patients get jealous of their immediate neighbors, so if two patients sit next to each other then the one with the higher rating must get more tablets. Therasa wants to save money, so she wants to minimize the total number of tablets.  \n\nInput\nThe first line of the input is an integer N, the number of patients in Therasa’s practice. Each of the following N lines contains an integer indicates the health score of each patient.\n\nOutput\nOutput a single line containing the minimum number of tablets Therasa must give.\n\nConstraints\n1 ≤ N ≤ 100000\n1 ≤ health score ≤ 100000  \n\nSAMPLE INPUT\n3\n1\n2\n2\n\nSAMPLE OUTPUT\n4\n\nExplanation\n\nHere 1, 2, 2 is the health score. Note that when two patients have equal health score they are allowed to have different number of tablets. Hence optimal distribution will be 1, 2, 1.\n\nExample input:\n```\n3\n1\n2\n2\n```\n\nExpected output for the example input:\n```\n4\n```\n\nMetadata: Difficulty: EASY | Source: https://www.hackerearth.com/practice/algorithms/dynamic-programming/introduction-to-dynamic-programming-1/practice-problems/algorithm/tablets/\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nN=int(input())\nscores=[int(input()) for x in range(N)]\n\ntablet=[0]*N\n\ntablet[0]=1\n\nfor i in range(1,N):\n\tif scores[i]>scores[i-1]:\n\t\ttablet[i]=tablet[i-1]+1\n\n\telse:\n\t\ttablet[i]=1\n\n\n\nfor i in range(N-2,-1,-1):\n\n\tif scores[i]>scores[i+1] and tablet[i]<=tablet[i+1]:\n\t\ttablet[i]=tablet[i+1]+1\n\n\n\nprint(sum(tablet))\n```"}]}, {"id": "TACO-47", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nYou are given two positive integer sequences $a_1, \\ldots, a_n$ and $b_1, \\ldots, b_m$. For each $j = 1, \\ldots, m$ find the greatest common divisor of $a_1 + b_j, \\ldots, a_n + b_j$.\n\n\n-----Input-----\n\nThe first line contains two integers $n$ and $m$ ($1 \\leq n, m \\leq 2 \\cdot 10^5$).\n\nThe second line contains $n$ integers $a_1, \\ldots, a_n$ ($1 \\leq a_i \\leq 10^{18})$.\n\nThe third line contains $m$ integers $b_1, \\ldots, b_m$ ($1 \\leq b_j \\leq 10^{18})$.\n\n\n-----Output-----\n\nPrint $m$ integers. The $j$-th of them should be equal to GCD$(a_1 + b_j, \\ldots, a_n + b_j)$.\n\n\n-----Examples-----\n\nInput\n4 4\n1 25 121 169\n1 2 7 23\nOutput\n2 3 8 24\n\n\n-----Note-----\n\nNone\n\nExample input:\n```\n4 4\n1 25 121 169\n1 2 7 23\n```\n\nExpected output for the example input:\n```\n2 3 8 24\n```\n\nMetadata: Difficulty: MEDIUM_HARD | Time limit: 2 seconds | Memory limit: 512 megabytes | Source: https://codeforces.com/problemset/problem/1458/A\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nfrom math import gcd\n(_, a, g) = (input(), list(map(int, input().split())), 0)\nfor v in a[1:]:\n\tg = gcd(g, v - a[0])\nprint(*[gcd(g, v + a[0]) for v in map(int, input().split())])\n```"}]}, {"id": "TACO-48", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nGena loves sequences of numbers. Recently, he has discovered a new type of sequences which he called an almost arithmetical progression. A sequence is an almost arithmetical progression, if its elements can be represented as:  a_1 = p, where p is some integer;  a_{i} = a_{i} - 1 + ( - 1)^{i} + 1·q (i > 1), where q is some integer. \n\nRight now Gena has a piece of paper with sequence b, consisting of n integers. Help Gena, find there the longest subsequence of integers that is an almost arithmetical progression.\n\nSequence s_1,  s_2,  ...,  s_{k} is a subsequence of sequence b_1,  b_2,  ...,  b_{n}, if there is such increasing sequence of indexes i_1, i_2, ..., i_{k} (1  ≤  i_1  <  i_2  < ...   <  i_{k}  ≤  n), that b_{i}_{j}  =  s_{j}. In other words, sequence s can be obtained from b by crossing out some elements.\n\n\n-----Input-----\n\nThe first line contains integer n (1 ≤ n ≤ 4000). The next line contains n integers b_1, b_2, ..., b_{n} (1 ≤ b_{i} ≤ 10^6).\n\n\n-----Output-----\n\nPrint a single integer — the length of the required longest subsequence.\n\n\n-----Examples-----\nInput\n2\n3 5\n\nOutput\n2\n\nInput\n4\n10 20 10 30\n\nOutput\n3\n\n\n\n-----Note-----\n\nIn the first test the sequence actually is the suitable subsequence. \n\nIn the second test the following subsequence fits: 10, 20, 10.\n\nExample input:\n```\n2\n3 5\n```\n\nExpected output for the example input:\n```\n2\n```\n\nMetadata: Difficulty: MEDIUM | Source: https://codeforces.com/problemset/problem/255/C\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nR = lambda : map(int, input().split())\nn = int(input())\narr = list(R())\ndp = [[0] * (n + 1) for i in range(n + 1)]\nfor i in range(n):\n\tp = -1\n\tfor j in range(i):\n\t\tdp[i][j] = max(dp[i][j], dp[j][p] + 1)\n\t\tp = j if arr[j] == arr[i] else p\nprint(max((max(dp[i]) for i in range(n))) + 1)\n```"}]}, {"id": "TACO-49", "source": "BAAI/TACO", "conversations": [{"from": "human", "value": "Problem:\nYou are given an array $a_1, a_2, \\ldots, a_n$ consisting of $n$ positive integers and a positive integer $m$.\n\nYou should divide elements of this array into some arrays. You can order the elements in the new arrays as you want.\n\nLet's call an array $m$-divisible if for each two adjacent numbers in the array (two numbers on the positions $i$ and $i+1$ are called adjacent for each $i$) their sum is divisible by $m$. An array of one element is $m$-divisible.\n\nFind the smallest number of $m$-divisible arrays that $a_1, a_2, \\ldots, a_n$ is possible to divide into.\n\n\n-----Input-----\n\nThe first line contains a single integer $t$ $(1 \\le t \\le 1000)$  — the number of test cases.\n\nThe first line of each test case contains two integers $n$, $m$ $(1 \\le n \\le 10^5, 1 \\le m \\le 10^5)$.\n\nThe second line of each test case contains $n$ integers $a_1, a_2, \\ldots, a_n$ $(1 \\le a_i \\le 10^9)$.\n\nIt is guaranteed that the sum of $n$ and the sum of $m$ over all test cases do not exceed $10^5$.\n\n\n-----Output-----\n\nFor each test case print the answer to the problem.\n\n\n-----Examples-----\n\nInput\n4\n6 4\n2 2 8 6 9 4\n10 8\n1 1 1 5 2 4 4 8 6 7\n1 1\n666\n2 2\n2 4\nOutput\n3\n6\n1\n1\n\n\n-----Note-----\n\nIn the first test case we can divide the elements as follows:\n\n$[4, 8]$. It is a $4$-divisible array because $4+8$ is divisible by $4$.\n\n$[2, 6, 2]$. It is a $4$-divisible array because $2+6$ and $6+2$ are divisible by $4$.\n\n$[9]$. It is a $4$-divisible array because it consists of one element.\n\nExample input:\n```\n4\n6 4\n2 2 8 6 9 4\n10 8\n1 1 1 5 2 4 4 8 6 7\n1 1\n666\n2 2\n2 4\n```\n\nExpected output for the example input:\n```\n3\n6\n1\n1\n```\n\nMetadata: Difficulty: EASY | Time limit: 1 second | Memory limit: 256 megabytes | Source: https://codeforces.com/problemset/problem/1497/B\n\nPlease write a **Python** solution that reads from stdin and writes to stdout."}, {"from": "gpt", "value": "```python\nfrom collections import Counter\nt = int(input())\nfor q in range(0, t):\n\t(n, m) = map(int, input().split())\n\ta = [int(x) % m for x in input().split()]\n\tcnt = Counter(a)\n\tans = 0\n\tfor i in set(a):\n\t\tif cnt[i] == -1000000000.0:\n\t\t\tcontinue\n\t\tr = (m - i) % m\n\t\tans += max(abs(cnt[r] - cnt[i]), 1)\n\t\tcnt[r] = -1000000000.0\n\tprint(ans)\n```"}]}]